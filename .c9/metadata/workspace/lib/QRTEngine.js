{"filter":false,"title":"QRTEngine.js","tooltip":"/lib/QRTEngine.js","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1526,"column":14},"end":{"row":1526,"column":15}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":14},"end":{"row":1526,"column":15}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":15},"end":{"row":1526,"column":16}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":16},"end":{"row":1526,"column":17}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":17},"end":{"row":1526,"column":18}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":18},"end":{"row":1526,"column":19}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":19},"end":{"row":1526,"column":20}},"text":"."}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":20},"end":{"row":1526,"column":21}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":21},"end":{"row":1526,"column":22}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":22},"end":{"row":1526,"column":23}},"text":"g"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":23},"end":{"row":1526,"column":25}},"text":"()"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":24},"end":{"row":1526,"column":25}},"text":"Q"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":25},"end":{"row":1526,"column":26}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":26},"end":{"row":1526,"column":27}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":27},"end":{"row":1526,"column":28}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":28},"end":{"row":1526,"column":29}},"text":"C"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1526,"column":24},"end":{"row":1526,"column":29}},"text":"QRTEC"},{"action":"insertText","range":{"start":{"row":1526,"column":24},"end":{"row":1526,"column":39}},"text":"QRTECURRENTFORM"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":39},"end":{"row":1526,"column":40}},"text":"U"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":40},"end":{"row":1526,"column":41}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":41},"end":{"row":1526,"column":42}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1526,"column":41},"end":{"row":1526,"column":42}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1526,"column":40},"end":{"row":1526,"column":41}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1526,"column":39},"end":{"row":1526,"column":40}},"text":"U"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":39},"end":{"row":1526,"column":40}},"text":"."}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":40},"end":{"row":1526,"column":41}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":41},"end":{"row":1526,"column":42}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":42},"end":{"row":1526,"column":43}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":43},"end":{"row":1526,"column":44}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":44},"end":{"row":1526,"column":45}},"text":"c"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1526,"column":45},"end":{"row":1526,"column":46}},"text":"t"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1524,"column":43},"end":{"row":1525,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":1525,"column":0},"end":{"row":1525,"column":12}},"text":"            "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1525,"column":12},"end":{"row":1525,"column":13}},"text":"d"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1525,"column":13},"end":{"row":1525,"column":14}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1525,"column":14},"end":{"row":1525,"column":15}},"text":"u"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1525,"column":14},"end":{"row":1525,"column":15}},"text":"u"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1525,"column":14},"end":{"row":1525,"column":15}},"text":"b"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1525,"column":15},"end":{"row":1525,"column":16}},"text":"u"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1525,"column":16},"end":{"row":1525,"column":17}},"text":"g"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1525,"column":17},"end":{"row":1525,"column":18}},"text":"g"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1525,"column":18},"end":{"row":1525,"column":19}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1525,"column":19},"end":{"row":1525,"column":20}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1525,"column":20},"end":{"row":1525,"column":21}},"text":";"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1467,"column":12},"end":{"row":1467,"column":36}},"text":"this.sliderLoadContainer"},{"action":"insertText","range":{"start":{"row":1467,"column":12},"end":{"row":1467,"column":13}},"text":"S"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":13},"end":{"row":1467,"column":14}},"text":"L"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":14},"end":{"row":1467,"column":15}},"text":"I"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":15},"end":{"row":1467,"column":16}},"text":"D"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":16},"end":{"row":1467,"column":17}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":17},"end":{"row":1467,"column":18}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":18},"end":{"row":1467,"column":19}},"text":"L"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":19},"end":{"row":1467,"column":20}},"text":"O"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":20},"end":{"row":1467,"column":21}},"text":"A"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":21},"end":{"row":1467,"column":22}},"text":"D"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":22},"end":{"row":1467,"column":23}},"text":"C"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":23},"end":{"row":1467,"column":24}},"text":"O"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":24},"end":{"row":1467,"column":25}},"text":"N"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":25},"end":{"row":1467,"column":26}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":26},"end":{"row":1467,"column":27}},"text":"A"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":27},"end":{"row":1467,"column":28}},"text":"I"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":28},"end":{"row":1467,"column":29}},"text":"N"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":29},"end":{"row":1467,"column":30}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":30},"end":{"row":1467,"column":31}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":12},"end":{"row":1467,"column":13}},"text":"Q"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":13},"end":{"row":1467,"column":14}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":14},"end":{"row":1467,"column":15}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1467,"column":15},"end":{"row":1467,"column":16}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":73},"end":{"row":1465,"column":74}},"text":","}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":74},"end":{"row":1465,"column":75}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":75},"end":{"row":1465,"column":76}},"text":"Q"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":76},"end":{"row":1465,"column":77}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":77},"end":{"row":1465,"column":78}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":78},"end":{"row":1465,"column":79}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":79},"end":{"row":1465,"column":80}},"text":"S"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":80},"end":{"row":1465,"column":81}},"text":"L"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":81},"end":{"row":1465,"column":82}},"text":"I"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":82},"end":{"row":1465,"column":83}},"text":"D"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":83},"end":{"row":1465,"column":84}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":84},"end":{"row":1465,"column":85}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":85},"end":{"row":1465,"column":86}},"text":"L"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":86},"end":{"row":1465,"column":87}},"text":"O"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":87},"end":{"row":1465,"column":88}},"text":"A"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":88},"end":{"row":1465,"column":89}},"text":"D"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":89},"end":{"row":1465,"column":90}},"text":"C"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":90},"end":{"row":1465,"column":91}},"text":"O"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":91},"end":{"row":1465,"column":92}},"text":"N"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":92},"end":{"row":1465,"column":93}},"text":"T"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":93},"end":{"row":1465,"column":94}},"text":"A"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":94},"end":{"row":1465,"column":95}},"text":"I"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":95},"end":{"row":1465,"column":96}},"text":"N"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":96},"end":{"row":1465,"column":97}},"text":"E"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1465,"column":97},"end":{"row":1465,"column":98}},"text":"R"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1521,"column":46},"end":{"row":1521,"column":70}},"text":"QRTE.sliderLoadContainer"},{"action":"insertText","range":{"start":{"row":1521,"column":46},"end":{"row":1521,"column":69}},"text":"QRTESLIDERLOADCONTAINER"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1522,"column":37},"end":{"row":1522,"column":61}},"text":"QRTE.sliderLoadContainer"},{"action":"insertText","range":{"start":{"row":1522,"column":37},"end":{"row":1522,"column":60}},"text":"QRTESLIDERLOADCONTAINER"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1527,"column":0},"end":{"row":1527,"column":47}},"text":"            console.log(QRTECURRENTFORM.select)"},{"action":"removeLines","range":{"start":{"row":1525,"column":0},"end":{"row":1527,"column":0}},"nl":"\n","lines":["            debugger;","            console.log(QRTECURRENTFORM);"]},{"action":"removeText","range":{"start":{"row":1524,"column":43},"end":{"row":1525,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1524,"column":43},"end":{"row":1525,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":1525,"column":0},"end":{"row":1525,"column":12}},"text":"            "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1464,"column":10},"end":{"row":1464,"column":11}},"text":"I"},{"action":"insertText","range":{"start":{"row":1464,"column":10},"end":{"row":1464,"column":11}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1464,"column":10},"end":{"row":1464,"column":11}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1495,"column":0},"end":{"row":1495,"column":42}},"text":"            console.log('Slider inited..')"},{"action":"removeText","range":{"start":{"row":1494,"column":13},"end":{"row":1495,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1530,"column":0},"end":{"row":1530,"column":50}},"text":"                console.log('found end of survey')"},{"action":"removeText","range":{"start":{"row":1529,"column":18},"end":{"row":1530,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1124,"column":17},"end":{"row":1124,"column":18}},"text":"/"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1124,"column":16},"end":{"row":1124,"column":17}},"text":"/"}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":373,"column":0},"end":{"row":377,"column":0}},"nl":"\n","lines":["            ","            if(typeof QRTESLIDERINITED === 'undefined') {","                QRTE.sliderInit();","            }"]},{"action":"removeText","range":{"start":{"row":645,"column":20},"end":{"row":645,"column":35}},"text":"QRTE.submitPage"},{"action":"insertText","range":{"start":{"row":645,"column":20},"end":{"row":645,"column":40}},"text":"this.clickNextButton"},{"action":"insertText","range":{"start":{"row":645,"column":42},"end":{"row":645,"column":43}},"text":";"},{"action":"removeLines","range":{"start":{"row":1443,"column":0},"end":{"row":1543,"column":0}},"nl":"\n","lines":["        },","        ","         //This plug-in to QRTEngine has been developed under the name SurveySlider","        // for general Qualtrics Surveys. It has been adapted to work with QRTEngine","        sliderLoadContainer: null,","        currentForm: null,","        previousForm: null,","        handlingSubmit: false,","        showResponse: false,","        initCount: 0,","        betweenSubmits: false,","        onSubmitStack: [],","        onSubmitFinish: [],","    ","        //Initialize the slider","        //There is a number of ghost variables that are initialised by this piece of code","        //There are global variables that are not pre-defined, and thus won't be overwritten","        // if this code is loaded for a second time.","        // These are: QRTESLIDERINITED, QRTECURRENTFORM, QRTEPREVIOUSFORM, QRTESLIDERLOADCONTAINER","        sliderInit: function() {","            QRTESLIDERLOADCONTAINER = new Element('div',{id: 'SliderLoadContainer'});","            QRTECURRENTFORM = $$('form')[0];","    ","            //Catch submits and change it with our own submit function (which does AJAX submissions)","            //this.currentForm.observe('QRTE:submit', QRTE.handleSubmit);","            this.currentElements = $$('.QuestionOuter');","            ","            //Initial SSload firing","            Qualtrics.SurveyEngine.addOnload(function() {","                QRTECURRENTFORM.fire('QRTE:load');","            });","            //Change SurveyEngine.OnLoad to trigger on SSload, rather than page load","            Qualtrics.SurveyEngine.addOnload = function(f) {","                questions = $$('.QuestionOuter')","                currentCount = QRTE.count(Qualtrics.SurveyEngine.QuestionInfo);","                id = questions[currentCount-1].id;","                if ($('body') && $('body').hasClassName('EditSection')) return;","                try {","                    var obj = new Qualtrics.SurveyEngine.QuestionData(id);","                    obj.onload = f;","                    ","                    QRTECURRENTFORM.observe('QRTE:load', obj.onload.bind(obj));","                    //Event.observe(QRTECURRENTFORM, 'SSload', obj.onload.bind(obj));","                }","                catch (e) {","                    console.error('SE API Error: ' + e);","                }","            }","            QRTE.submitPage = QRTE.handleSubmit;","            QRTESLIDERINITED = true;","        },","    ","        handleSubmit: function() {","            if (QRTE.handlingSubmit === false) {","                QRTE.handlingSubmit = true","    ","                //Loop over submit stack","                for (index = 0; index < QRTE.onSubmitStack.length; index += 1) {","                    QRTE.onSubmitStack[index]();","                }","                QRTE.onSubmitStack = []","                QRTECURRENTFORM.request({","                    onComplete: QRTE.handleSubmitCallback","                })","    ","                QRTE.betweenSubmits = true;","            }","        },","    ","        handleSubmitCallback: function(e) {","            QRTE.handlingSubmit = false;","            QRTEPREVIOUSFORM = QRTECURRENTFORM;","            Qualtrics.SurveyEngine.QuestionInfo = {}","            QRTE.sliderLoadContainer = jQuery(QRTESLIDERLOADCONTAINER).html(e.responseText)[0];","            QRTECURRENTFORM = jQuery(QRTESLIDERLOADCONTAINER).find('form')[0];","            jQuery(QRTEPREVIOUSFORM).replaceWith(jQuery(QRTECURRENTFORM));","            jQuery(QRTECURRENTFORM).show();","            ","            if (QRTECURRENTFORM.select('.END_OF_SURVEY').length === 0) {","                QRTECURRENTFORM.fire('QRTE:load');","                QRTE.submitPage = QRTE.handleSubmit;","            }","            else {","                QRTE.submitPage = QRTECURRENTFORM.submit;","            }","        },","        ","        submitPage: function() {","            console.log('Not yet initialised');","        },","    ","        count: function(obj) {","            var count = 0;","    ","            for (var prop in obj) {","                if (obj.hasOwnProperty(prop))","                    ++count;","            }","    ","            return count;"]},{"action":"removeLines","range":{"start":{"row":1519,"column":0},"end":{"row":1557,"column":0}},"nl":"\n","lines":["    ","    function loadScript(url, callback) {","    ","        var script = document.createElement(\"script\")","        script.type = \"text/javascript\";","    ","        if (script.readyState) { //IE","            script.onreadystatechange = function() {","                if (script.readyState == \"loaded\" || script.readyState == \"complete\") {","                    script.onreadystatechange = null;","                    callback();","                }","    ","            };","        }","        else { //Others","            script.onload = function() {","                callback();","            };","        }","    ","        script.src = url;","        document.getElementsByTagName(\"head\")[0].appendChild(script);","    }","    ","    (function() {","        ","        //jQuery is only required for the Fixation flash fix. prototypejs is unable to efficiently replace elements","        //and introduces a 10 ms delay between loading element and firing off the scripts. Unacceptable","        //First time jQuery should be used is the second trial","    ","        loadScript(\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\", function() {","    ","            $.noConflict();","    ","        });","    ","    })();"]}]}]]},"ace":{"folds":[],"scrolltop":19785,"scrollleft":0,"selection":{"start":{"row":1121,"column":13},"end":{"row":1121,"column":13},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":1412,"state":"no_regex","mode":"ace/mode/javascript"}},"timestamp":1413806288413,"hash":"fbebcff5f249bb9a03f9c8f03f9c3299a05ab1cc"}