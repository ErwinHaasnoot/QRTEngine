{"filter":false,"title":"QRTEngine.js","tooltip":"/lib/QRTEngine.js","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":1641,"column":43},"end":{"row":1641,"column":44},"action":"insert","lines":["t"],"id":9534}],[{"start":{"row":1641,"column":44},"end":{"row":1641,"column":45},"action":"insert","lines":["r"],"id":9535}],[{"start":{"row":1641,"column":45},"end":{"row":1641,"column":46},"action":"insert","lines":["i"],"id":9536}],[{"start":{"row":1641,"column":46},"end":{"row":1641,"column":47},"action":"insert","lines":["c"],"id":9537}],[{"start":{"row":1641,"column":47},"end":{"row":1641,"column":48},"action":"insert","lines":["s"],"id":9538}],[{"start":{"row":1641,"column":48},"end":{"row":1641,"column":49},"action":"insert","lines":[" "],"id":9539}],[{"start":{"row":1641,"column":49},"end":{"row":1641,"column":50},"action":"insert","lines":["P"],"id":9540}],[{"start":{"row":1641,"column":50},"end":{"row":1641,"column":51},"action":"insert","lines":["a"],"id":9541}],[{"start":{"row":1641,"column":51},"end":{"row":1641,"column":52},"action":"insert","lines":["g"],"id":9542}],[{"start":{"row":1641,"column":52},"end":{"row":1641,"column":53},"action":"insert","lines":["e"],"id":9543}],[{"start":{"row":1641,"column":53},"end":{"row":1642,"column":0},"action":"insert","lines":["",""],"id":9544},{"start":{"row":1642,"column":0},"end":{"row":1642,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":1642,"column":16},"end":{"row":1642,"column":17},"action":"insert","lines":["*"],"id":9545}],[{"start":{"row":1642,"column":17},"end":{"row":1642,"column":18},"action":"insert","lines":["/"],"id":9546}],[{"start":{"row":1642,"column":18},"end":{"row":1643,"column":0},"action":"insert","lines":["",""],"id":9547},{"start":{"row":1643,"column":0},"end":{"row":1643,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":1645,"column":16},"end":{"row":1645,"column":17},"action":"insert","lines":["P"],"id":9548}],[{"start":{"row":1645,"column":17},"end":{"row":1645,"column":18},"action":"insert","lines":["a"],"id":9549}],[{"start":{"row":1645,"column":18},"end":{"row":1645,"column":19},"action":"insert","lines":["g"],"id":9550}],[{"start":{"row":1645,"column":19},"end":{"row":1645,"column":20},"action":"insert","lines":["e"],"id":9551}],[{"start":{"row":1645,"column":20},"end":{"row":1645,"column":21},"action":"insert","lines":["."],"id":9552}],[{"start":{"row":1645,"column":21},"end":{"row":1645,"column":22},"action":"insert","lines":["."],"id":9553}],[{"start":{"row":1645,"column":22},"end":{"row":1645,"column":23},"action":"insert","lines":["."],"id":9554}],[{"start":{"row":1645,"column":22},"end":{"row":1645,"column":23},"action":"remove","lines":["."],"id":9555}],[{"start":{"row":1645,"column":21},"end":{"row":1645,"column":22},"action":"remove","lines":["."],"id":9556}],[{"start":{"row":1645,"column":21},"end":{"row":1645,"column":40},"action":"insert","lines":["_renderPageTemplate"],"id":9557}],[{"start":{"row":1645,"column":40},"end":{"row":1645,"column":41},"action":"insert","lines":["("],"id":9558}],[{"start":{"row":1645,"column":41},"end":{"row":1645,"column":42},"action":"insert","lines":["t"],"id":9559}],[{"start":{"row":1645,"column":42},"end":{"row":1645,"column":43},"action":"insert","lines":["h"],"id":9560}],[{"start":{"row":1645,"column":43},"end":{"row":1645,"column":44},"action":"insert","lines":["i"],"id":9561}],[{"start":{"row":1645,"column":44},"end":{"row":1645,"column":45},"action":"insert","lines":["s"],"id":9562}],[{"start":{"row":1645,"column":45},"end":{"row":1645,"column":46},"action":"insert","lines":["."],"id":9563}],[{"start":{"row":1645,"column":46},"end":{"row":1645,"column":47},"action":"insert","lines":["n"],"id":9564}],[{"start":{"row":1645,"column":47},"end":{"row":1645,"column":48},"action":"insert","lines":["e"],"id":9565}],[{"start":{"row":1645,"column":48},"end":{"row":1645,"column":49},"action":"insert","lines":["x"],"id":9566}],[{"start":{"row":1645,"column":49},"end":{"row":1645,"column":50},"action":"insert","lines":["t"],"id":9567}],[{"start":{"row":1645,"column":50},"end":{"row":1645,"column":51},"action":"insert","lines":["T"],"id":9568}],[{"start":{"row":1645,"column":51},"end":{"row":1645,"column":52},"action":"insert","lines":["r"],"id":9569}],[{"start":{"row":1645,"column":52},"end":{"row":1645,"column":53},"action":"insert","lines":["a"],"id":9570}],[{"start":{"row":1645,"column":53},"end":{"row":1645,"column":54},"action":"insert","lines":["i"],"id":9571}],[{"start":{"row":1645,"column":53},"end":{"row":1645,"column":54},"action":"remove","lines":["i"],"id":9572}],[{"start":{"row":1645,"column":52},"end":{"row":1645,"column":53},"action":"remove","lines":["a"],"id":9573}],[{"start":{"row":1645,"column":52},"end":{"row":1645,"column":53},"action":"insert","lines":["i"],"id":9574}],[{"start":{"row":1645,"column":53},"end":{"row":1645,"column":54},"action":"insert","lines":["a"],"id":9575}],[{"start":{"row":1645,"column":54},"end":{"row":1645,"column":55},"action":"insert","lines":["l"],"id":9576}],[{"start":{"row":1645,"column":55},"end":{"row":1645,"column":56},"action":"insert","lines":["T"],"id":9577}],[{"start":{"row":1645,"column":56},"end":{"row":1645,"column":57},"action":"insert","lines":["e"],"id":9578}],[{"start":{"row":1645,"column":57},"end":{"row":1645,"column":58},"action":"insert","lines":["x"],"id":9579}],[{"start":{"row":1645,"column":58},"end":{"row":1645,"column":59},"action":"insert","lines":["t"],"id":9580}],[{"start":{"row":1645,"column":59},"end":{"row":1645,"column":60},"action":"insert","lines":[","],"id":9581}],[{"start":{"row":1645,"column":60},"end":{"row":1645,"column":61},"action":"insert","lines":["\""],"id":9582}],[{"start":{"row":1645,"column":61},"end":{"row":1645,"column":62},"action":"insert","lines":["n"],"id":9583}],[{"start":{"row":1645,"column":62},"end":{"row":1645,"column":63},"action":"insert","lines":["e"],"id":9584}],[{"start":{"row":1645,"column":63},"end":{"row":1645,"column":64},"action":"insert","lines":["x"],"id":9585}],[{"start":{"row":1645,"column":64},"end":{"row":1645,"column":65},"action":"insert","lines":["t"],"id":9586}],[{"start":{"row":1645,"column":65},"end":{"row":1645,"column":66},"action":"insert","lines":["\""],"id":9587}],[{"start":{"row":1645,"column":66},"end":{"row":1645,"column":67},"action":"insert","lines":[")"],"id":9588}],[{"start":{"row":1645,"column":67},"end":{"row":1645,"column":68},"action":"insert","lines":[";"],"id":9589}],[{"start":{"row":1645,"column":68},"end":{"row":1645,"column":69},"action":"insert","lines":[" "],"id":9590}],[{"start":{"row":1645,"column":69},"end":{"row":1645,"column":70},"action":"insert","lines":["/"],"id":9591}],[{"start":{"row":1645,"column":70},"end":{"row":1645,"column":71},"action":"insert","lines":["/"],"id":9592}],[{"start":{"row":1648,"column":42},"end":{"row":1648,"column":72},"action":"remove","lines":["this.nextTrialContainer).find("],"id":9593},{"start":{"row":1648,"column":42},"end":{"row":1648,"column":43},"action":"remove","lines":["'"]}],[{"start":{"row":1648,"column":42},"end":{"row":1648,"column":43},"action":"insert","lines":["'"],"id":9594}],[{"start":{"row":1648,"column":43},"end":{"row":1648,"column":44},"action":"insert","lines":["#"],"id":9595}],[{"start":{"row":1648,"column":43},"end":{"row":1648,"column":44},"action":"remove","lines":["#"],"id":9596}],[{"start":{"row":1646,"column":66},"end":{"row":1647,"column":25},"action":"remove","lines":["","                debugger;"],"id":9597}],[{"start":{"row":1646,"column":66},"end":{"row":1647,"column":0},"action":"insert","lines":["",""],"id":9598},{"start":{"row":1647,"column":0},"end":{"row":1647,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":653,"column":40},"end":{"row":654,"column":29},"action":"remove","lines":["","                    debugger;"],"id":9599}],[{"start":{"row":682,"column":40},"end":{"row":682,"column":49},"action":"remove","lines":["e.path[0]"],"id":9600},{"start":{"row":682,"column":40},"end":{"row":682,"column":48},"action":"insert","lines":["e.target"]}],[{"start":{"row":782,"column":12},"end":{"row":782,"column":13},"action":"insert","lines":["/"],"id":9601}],[{"start":{"row":782,"column":13},"end":{"row":782,"column":14},"action":"insert","lines":["/"],"id":9602}],[{"start":{"row":654,"column":51},"end":{"row":655,"column":0},"action":"insert","lines":["",""],"id":9607},{"start":{"row":655,"column":0},"end":{"row":655,"column":20},"action":"insert","lines":["                    "]}],[{"start":{"row":655,"column":20},"end":{"row":656,"column":48},"action":"insert","lines":["","                        $('NextButton').click();"],"id":9608}],[{"start":{"row":656,"column":0},"end":{"row":656,"column":4},"action":"remove","lines":["    "],"id":9609}],[{"start":{"row":654,"column":20},"end":{"row":654,"column":21},"action":"insert","lines":["/"],"id":9610}],[{"start":{"row":654,"column":21},"end":{"row":654,"column":22},"action":"insert","lines":["/"],"id":9611}],[{"start":{"row":1872,"column":8},"end":{"row":1873,"column":0},"action":"insert","lines":["",""],"id":9612,"ignore":true}],[{"start":{"row":2,"column":22},"end":{"row":2,"column":23},"action":"remove","lines":["6"],"id":9613,"ignore":true},{"start":{"row":2,"column":22},"end":{"row":2,"column":23},"action":"insert","lines":["5"]},{"start":{"row":4,"column":21},"end":{"row":4,"column":26},"action":"remove","lines":["-2014"]},{"start":{"row":32,"column":0},"end":{"row":32,"column":23},"action":"remove","lines":["        version: 'v16',"]},{"start":{"row":41,"column":10},"end":{"row":41,"column":11},"action":"insert","lines":[" "]},{"start":{"row":108,"column":52},"end":{"row":108,"column":53},"action":"insert","lines":[" "]},{"start":{"row":116,"column":48},"end":{"row":116,"column":49},"action":"insert","lines":[" "]},{"start":{"row":122,"column":0},"end":{"row":123,"column":0},"action":"remove","lines":["            //Store value in trial cache",""]},{"start":{"row":124,"column":0},"end":{"row":125,"column":0},"action":"remove","lines":["                //Add column to overall trial data",""]},{"start":{"row":139,"column":48},"end":{"row":139,"column":49},"action":"insert","lines":[" "]},{"start":{"row":150,"column":56},"end":{"row":150,"column":57},"action":"insert","lines":[" "]},{"start":{"row":167,"column":0},"end":{"row":169,"column":0},"action":"remove","lines":["            //Store blockData in ED so that we can use it next trial","            QRTEController.storeBlockData(QRTE.BDCache);",""]},{"start":{"row":173,"column":65},"end":{"row":173,"column":66},"action":"insert","lines":[" "]},{"start":{"row":195,"column":0},"end":{"row":196,"column":0},"action":"remove","lines":["            //This only works if the Survey Data has been set during the same trial due to a bug in Qualtrics.",""]},{"start":{"row":211,"column":13},"end":{"row":212,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":233,"column":13},"end":{"row":234,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":293,"column":0},"end":{"row":311,"column":0},"action":"remove","lines":["        /** ","         * Wait for images to load before starting trial.","         * @property waitForImageLoad","         * @private","         * @type Boolean","         */","","        waitForImageLoad: true,","","        /** ","         * Trial Start waiting list - initialised with waiting for TrialStart","         * @property loadWaitingList","         * @private","         * @type Array","         */","","        loadWaitingList: [false],","",""]},{"start":{"row":306,"column":31},"end":{"row":306,"column":33},"action":"remove","lines":["Id"]},{"start":{"row":306,"column":31},"end":{"row":306,"column":82},"action":"insert","lines":["DataString, blockId, columns, idData, exitQuestions"]},{"start":{"row":312,"column":0},"end":{"row":317,"column":0},"action":"remove","lines":["            //Initialise block Data","            blockDataString = Qualtrics.SurveyEngine.getEmbeddedData(this.blockDataField)|| '';","            columns = Qualtrics.SurveyEngine.getEmbeddedData(this.columnsField)|| '';","            idData = Qualtrics.SurveyEngine.getEmbeddedData(this.idField)|| '';","            exitQuestions = Qualtrics.SurveyEngine.getEmbeddedData(this.exitQuestions)|| '';",""]},{"start":{"row":317,"column":27},"end":{"row":317,"column":56},"action":"remove","lines":["QRTEController.loadBlockData("]},{"start":{"row":317,"column":42},"end":{"row":317,"column":52},"action":"insert","lines":[".evalJSON("]},{"start":{"row":320,"column":0},"end":{"row":321,"column":0},"action":"remove","lines":["                //If this is a new block, initialise a new block",""]},{"start":{"row":331,"column":0},"end":{"row":332,"column":0},"action":"remove","lines":["                //And update the exit questions",""]},{"start":{"row":345,"column":0},"end":{"row":355,"column":0},"action":"insert","lines":["            QRTE.log(QRTE.SDCache);","        },","        ","        deepClone: function(ele) {","           var clone = ele.clone();","           var children = ele.children;","           for(var i = 0; i < children.length; i += 1) {","               clone.appendChild(QRTE.deepClone(children[i]));","           }","           return  clone; ",""]},{"start":{"row":370,"column":0},"end":{"row":371,"column":0},"action":"remove","lines":["         *  @param [paramObj.waitForImages] {Boolean} Specify whether we should wait for images or not. Is on by default, but could be turned off if all images are pre-loaded in cache, or are very small in general.",""]},{"start":{"row":373,"column":14},"end":{"row":373,"column":30},"action":"remove","lines":["init the library"]},{"start":{"row":373,"column":14},"end":{"row":374,"column":0},"action":"insert","lines":["Quickly Hide the Questions in the Survey",""]},{"start":{"row":376,"column":0},"end":{"row":377,"column":0},"action":"remove","lines":["",""]},{"start":{"row":376,"column":14},"end":{"row":380,"column":31},"action":"remove","lines":["set the initIndex (if the Init question is not the first question of the block)","            QRTE.initIndex = paramObj.initQuestionIndex - 1 || 0;","","","            validationArray = ["]},{"start":{"row":376,"column":14},"end":{"row":395,"column":15},"action":"insert","lines":["QRTE.removeSeparators();","","            QRTE.initIndex = paramObj.initQuestionIndex - 1 || 0;","            ","            //UNCOMMENT","            //QRTE.debugFirst = QRTE.deepClone($$('.Skin')[0]);","","            validationArray = [{","                name: 'blockData',","                type: ['JSON', 'Empty'],","                required: true","            }, {","                name: 'columnData',","                type: ['JSON', 'Empty'],","                required: true","            }, {","                name: 'idData',","                type: ['JSON', 'Empty'],","                required: true","            }, "]},{"start":{"row":408,"column":27},"end":{"row":408,"column":34},"action":"remove","lines":["ItemTag"]},{"start":{"row":408,"column":27},"end":{"row":408,"column":36},"action":"insert","lines":["Questions"]},{"start":{"row":412,"column":23},"end":{"row":412,"column":36},"action":"remove","lines":["waitForImages"]},{"start":{"row":412,"column":23},"end":{"row":412,"column":34},"action":"insert","lines":["exitItemTag"]},{"start":{"row":413,"column":24},"end":{"row":413,"column":31},"action":"remove","lines":["Boolean"]},{"start":{"row":413,"column":24},"end":{"row":413,"column":30},"action":"insert","lines":["String"]},{"start":{"row":414,"column":26},"end":{"row":414,"column":30},"action":"remove","lines":["fals"]},{"start":{"row":414,"column":26},"end":{"row":414,"column":29},"action":"insert","lines":["tru"]},{"start":{"row":420,"column":0},"end":{"row":421,"column":0},"action":"remove","lines":["",""]},{"start":{"row":421,"column":39},"end":{"row":426,"column":13},"action":"remove","lines":["Id, paramObj.exitItemTag);","","","            if (paramObj.waitForImages !== undefined) {","                QRTE.waitForImageLoad = paramObj.waitForImages;","            }"]},{"start":{"row":421,"column":39},"end":{"row":422,"column":0},"action":"insert","lines":["Data, paramObj.blockId, paramObj.columnData, paramObj.idData, paramObj.exitQuestions, paramObj.exitItemTag);",""]},{"start":{"row":425,"column":0},"end":{"row":426,"column":0},"action":"remove","lines":["",""]},{"start":{"row":462,"column":13},"end":{"row":463,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":464,"column":61},"end":{"row":464,"column":62},"action":"insert","lines":[" "]},{"start":{"row":482,"column":0},"end":{"row":485,"column":0},"action":"remove","lines":["         *  @param [paramObj.onHideFn] {Function} Function to be called upon Stimulus being hidden","         *  @param [paramObj.duringDisplayFn] {Function} Function to be called during each frame that the Stimulus is being displayed","         ",""]},{"start":{"row":528,"column":0},"end":{"row":532,"column":0},"action":"remove","lines":["            }, {","                name: 'onHideFn',","                type: ['Function'],","                required: false",""]},{"start":{"row":539,"column":0},"end":{"row":540,"column":0},"action":"insert","lines":["            QRTE.log(paramObj.conditional);",""]},{"start":{"row":553,"column":0},"end":{"row":554,"column":0},"action":"insert","lines":["                this.hideChoices();",""]},{"start":{"row":559,"column":0},"end":{"row":561,"column":0},"action":"remove","lines":["                    duringDisplayFn: paramObj.duringDisplayFn,","                    onHideFn: paramObj.onHideFn,",""]},{"start":{"row":563,"column":0},"end":{"row":564,"column":0},"action":"insert","lines":["                    duringDisplayFn: paramObj.duringDisplayFn,",""]},{"start":{"row":581,"column":0},"end":{"row":582,"column":0},"action":"remove","lines":["",""]},{"start":{"row":581,"column":0},"end":{"row":582,"column":12},"action":"insert","lines":["            ","            "]},{"start":{"row":606,"column":93},"end":{"row":607,"column":74},"action":"remove","lines":["","                    QRTE.setTrialData('QRTEngine[Version]', QRTE.version);"]},{"start":{"row":611,"column":24},"end":{"row":611,"column":26},"action":"remove","lines":["//"]},{"start":{"row":637,"column":20},"end":{"row":640,"column":23},"action":"remove","lines":["//QRTE.submitPage();","                    //QRTEController.loadNextTrial();","                    ","                    $('"]},{"start":{"row":637,"column":20},"end":{"row":637,"column":30},"action":"insert","lines":["this.click"]},{"start":{"row":637,"column":40},"end":{"row":637,"column":48},"action":"remove","lines":["').click"]},{"start":{"row":651,"column":32},"end":{"row":651,"column":33},"action":"remove","lines":["0"]},{"start":{"row":654,"column":0},"end":{"row":655,"column":0},"action":"remove","lines":["",""]},{"start":{"row":654,"column":12},"end":{"row":654,"column":14},"action":"insert","lines":["//"]},{"start":{"row":654,"column":19},"end":{"row":671,"column":0},"action":"remove","lines":["loadWaitingList = [false];","            if (QRTE.waitForImageLoad === true) {","                //set wait for image load queues.","                var loadIndex = 1,","                    images = $$('.QuestionOuter img'),","                    i = 0;","","                var l = images.length;","                for (; i < l; i += 1) {","                    images[i].observe('load', function(e) {","                        QRTE.startTrial(e.target.QRTELoadIndex);","                    })","                    images[i].QRTELoadIndex = i + 1;","                    QRTE.loadWaitingList[i + 1] = false;","                }","","            }",""]},{"start":{"row":654,"column":19},"end":{"row":654,"column":64},"action":"insert","lines":["debugSecond = QRTE.deepClone($$('.Skin')[0]);"]},{"start":{"row":677,"column":29},"end":{"row":677,"column":36},"action":"remove","lines":["startId"]},{"start":{"row":682,"column":0},"end":{"row":688,"column":0},"action":"remove","lines":["            QRTE.loadWaitingList[startId] = true;","            if (!QRTE.loadWaitingList.every()) {","                QRTE.log('Process ' + startId + 'finished, waiting for other processes to finish')","                return;","            }","",""]},{"start":{"row":686,"column":0},"end":{"row":687,"column":0},"action":"insert","lines":["            //QRTE.debugThird = QRTE.deepClone($$('.Skin')[0]);",""]},{"start":{"row":697,"column":0},"end":{"row":698,"column":0},"action":"remove","lines":["                    //Get current time, required for ",""]},{"start":{"row":700,"column":35},"end":{"row":702,"column":28},"action":"insert","lines":["","                    /*var sum = 0,","                        i;*/"]},{"start":{"row":713,"column":13},"end":{"row":714,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":732,"column":0},"end":{"row":746,"column":0},"action":"remove","lines":["            QRTE.inited = true;","","            //Set initial trial data related to loading of this trial","            QRTE.setTrialData('InitServerComm[Onset]', QRTE.getBlockData('ServerCommOnset'));","            QRTE.setTrialData('InitServerComm[Offset]', QRTE.getBlockData('ServerCommOffset'));","            QRTE.setTrialData('InitServerComm[CalculatedDuration]', QRTE.getBlockData('ServerCommOffset') - QRTE.getBlockData('ServerCommOnset'));","","            //<Load next trial here>","            var currentLoops = '${lm://CurrentLoopNumber}',","                totalLoops = '${lm://TotalLoops}';","            //Check if last trial, currentloops === totalLoops;","            ","            //QRTEController.requestNextTrial(currentLoops !== '' && currentLoops === totalLoops);","",""]},{"start":{"row":795,"column":75},"end":{"row":795,"column":76},"action":"insert","lines":[" "]},{"start":{"row":809,"column":0},"end":{"row":810,"column":0},"action":"insert","lines":["",""]},{"start":{"row":854,"column":29},"end":{"row":855,"column":27},"action":"insert","lines":["","                           "]},{"start":{"row":867,"column":25},"end":{"row":868,"column":23},"action":"insert","lines":["","                       "]},{"start":{"row":904,"column":57},"end":{"row":905,"column":35},"action":"remove","lines":[",","                    id: question.id"]},{"start":{"row":1010,"column":12},"end":{"row":1010,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1011,"column":0},"end":{"row":1011,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1012,"column":20},"end":{"row":1012,"column":23},"action":"remove","lines":["   "]},{"start":{"row":1012,"column":20},"end":{"row":1012,"column":21},"action":"remove","lines":[" "]},{"start":{"row":1013,"column":0},"end":{"row":1013,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1014,"column":16},"end":{"row":1014,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1015,"column":16},"end":{"row":1015,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1015,"column":16},"end":{"row":1015,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1016,"column":0},"end":{"row":1016,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1017,"column":0},"end":{"row":1017,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1018,"column":16},"end":{"row":1018,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1019,"column":0},"end":{"row":1019,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1020,"column":16},"end":{"row":1020,"column":18},"action":"remove","lines":["  "]},{"start":{"row":1020,"column":16},"end":{"row":1020,"column":18},"action":"remove","lines":["  "]},{"start":{"row":1021,"column":16},"end":{"row":1021,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1022,"column":0},"end":{"row":1022,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1023,"column":16},"end":{"row":1023,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1023,"column":16},"end":{"row":1023,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1024,"column":16},"end":{"row":1024,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1025,"column":12},"end":{"row":1025,"column":15},"action":"remove","lines":["   "]},{"start":{"row":1025,"column":12},"end":{"row":1025,"column":13},"action":"remove","lines":[" "]},{"start":{"row":1026,"column":0},"end":{"row":1026,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1027,"column":16},"end":{"row":1027,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1028,"column":12},"end":{"row":1028,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1028,"column":12},"end":{"row":1028,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1029,"column":0},"end":{"row":1029,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1030,"column":0},"end":{"row":1030,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1112,"column":16},"end":{"row":1114,"column":17},"action":"remove","lines":["for (var i = 0; i < arguments.length; i += 1) {","                    console.log(arguments[i]);","                }"]},{"start":{"row":1112,"column":16},"end":{"row":1112,"column":39},"action":"insert","lines":["console.log(arguments);"]},{"start":{"row":1170,"column":12},"end":{"row":1170,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1171,"column":0},"end":{"row":1171,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1172,"column":12},"end":{"row":1172,"column":13},"action":"remove","lines":[" "]},{"start":{"row":1172,"column":12},"end":{"row":1172,"column":15},"action":"remove","lines":["   "]},{"start":{"row":1173,"column":0},"end":{"row":1173,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1174,"column":12},"end":{"row":1174,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1174,"column":12},"end":{"row":1174,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1175,"column":0},"end":{"row":1175,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1176,"column":12},"end":{"row":1176,"column":15},"action":"remove","lines":["   "]},{"start":{"row":1176,"column":12},"end":{"row":1176,"column":13},"action":"remove","lines":[" "]},{"start":{"row":1177,"column":0},"end":{"row":1177,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1178,"column":0},"end":{"row":1178,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1179,"column":16},"end":{"row":1179,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1180,"column":12},"end":{"row":1180,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1181,"column":16},"end":{"row":1181,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1181,"column":16},"end":{"row":1181,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1182,"column":12},"end":{"row":1182,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1183,"column":16},"end":{"row":1183,"column":18},"action":"remove","lines":["  "]},{"start":{"row":1183,"column":16},"end":{"row":1183,"column":18},"action":"remove","lines":["  "]},{"start":{"row":1184,"column":12},"end":{"row":1184,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1185,"column":16},"end":{"row":1185,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1185,"column":16},"end":{"row":1185,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1186,"column":12},"end":{"row":1186,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1187,"column":0},"end":{"row":1187,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1196,"column":17},"end":{"row":1197,"column":15},"action":"insert","lines":["","               "]},{"start":{"row":1242,"column":13},"end":{"row":1243,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":1261,"column":20},"end":{"row":1261,"column":55},"action":"remove","lines":["QRTE.proceedOnFrameEnd === true || "]},{"start":{"row":1264,"column":17},"end":{"row":1265,"column":15},"action":"insert","lines":["","               "]},{"start":{"row":1279,"column":17},"end":{"row":1280,"column":15},"action":"insert","lines":["","               "]},{"start":{"row":1291,"column":15},"end":{"row":1291,"column":16},"action":"remove","lines":["("]},{"start":{"row":1291,"column":64},"end":{"row":1291,"column":89},"action":"remove","lines":[" && QRTE.inited === true)"]},{"start":{"row":1305,"column":13},"end":{"row":1306,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":1333,"column":12},"end":{"row":1333,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1334,"column":12},"end":{"row":1334,"column":14},"action":"remove","lines":["//"]},{"start":{"row":1338,"column":0},"end":{"row":1340,"column":0},"action":"remove","lines":["","",""]},{"start":{"row":1338,"column":0},"end":{"row":1340,"column":12},"action":"insert","lines":["            ","            ","            "]},{"start":{"row":1347,"column":13},"end":{"row":1348,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":1356,"column":0},"end":{"row":1356,"column":12},"action":"insert","lines":["            "]},{"start":{"row":1363,"column":12},"end":{"row":1363,"column":14},"action":"remove","lines":["//"]},{"start":{"row":1387,"column":0},"end":{"row":1387,"column":8},"action":"insert","lines":["        "]},{"start":{"row":1393,"column":8},"end":{"row":1393,"column":9},"action":"remove","lines":[" "]},{"start":{"row":1410,"column":0},"end":{"row":1410,"column":8},"action":"insert","lines":["        "]},{"start":{"row":1416,"column":8},"end":{"row":1416,"column":9},"action":"remove","lines":[" "]},{"start":{"row":1427,"column":58},"end":{"row":1427,"column":59},"action":"remove","lines":[" "]},{"start":{"row":1435,"column":9},"end":{"row":1435,"column":10},"action":"remove","lines":[","]},{"start":{"row":1438,"column":4},"end":{"row":1617,"column":89},"action":"remove","lines":["if (typeof QRTEController == 'undefined') {","        //QRTE SurveySlider controller layer","        //Takes care of progressing through the survey. Catches all qualtrics native ways of submitting the form and replaces that by","        //its own asynchronous ajax stuff.","        QRTEController = {","","","            //This plug-in to QRTEngine has been developed under the name SurveySlider","            // for general Qualtrics Surveys. It has been adapted to work with QRTEngine","            nextTrialContainer: null,","            nextTrialText: '',","            currentForm: null,","            previousForm: null,","            handlingSubmit: false,","            onSubmitStack: [],","            inited: false,","            childInputs: [],","            loadUponCallback: false,","            setEmbeddedData: function() {},","            tempED: {},","","","","            //Initialize thecontroller","            init: function() {","                this.nextTrialContainer = new Element('div', {","                    id: 'nextTrialContainer'","                });","                this.currentForm = $$('form')[0];","                //Catch submits and change it with our own submit function (which does AJAX submissions)","                //this.currentForm.observe('QRTE:submit', QRTE.handleSubmit);","                this.currentElements = $$('.QuestionOuter');","","                //Initial SSload firing","                Qualtrics.SurveyEngine.addOnload(function() {","                    QRTEController.currentForm.fire('QRTE:load');","                });","                //Change SurveyEngine.OnLoad to trigger on SSload, rather than page load","                Qualtrics.SurveyEngine.addOnload = function(e) {","                        var questions = $$('.QuestionOuter'),","                            currentCount = QRTEController.count(Qualtrics.SurveyEngine.QuestionInfo),","                            id = questions[currentCount - 1].id;","                        var t = new Qualtrics.SurveyEngine.QuestionData;","                        this.Page.once(\"preready\", function() {","                            try {","                                e.apply(t)","                            } catch (n) {","                                s.error(\"SE API Error: \", n, e)","                            }","                        })","                    }","                    //Set the Qualtrics setEmbeddedData to inside the QRTEController","                ","                // Overwrite Page.__advancePage","                advancePage = Page.__advancePage","                ","                Page.__advancePage = function(e,t,n) {","                    console.log(e,t,n)","                    advancePage.apply(Page,[e,t,n])","                }","                QRTEController.setEmbeddedData = Qualtrics.SurveyEngine.setEmbeddedData;","                Qualtrics.SurveyEngine.setEmbeddedData = function(key, value) {","                    QRTEController.tempED[key] = value;","                }","                this.submitPage = this.requestNextTrial;","                this.inited = true;","            },","","            /**","             * Requests the next trial from the Qualtrics server.","             *","             *","             */","            requestNextTrial: function(isLastTrial) {","","                //If this is the last trial of a block, DON'T request the next page, let qualtrics handle it themselves","                if (this.handlingSubmit === false && isLastTrial === false) {","                    //Load next trial means that current page is a trial and has been inited","                    //Need to remove relevant input elements from current form before submitting","                    //After that add them back","                    this.handlingSubmit = true","                    var childs = $$('form input[type=text]'),","                        childInputs = [];","                    //remove current input elements from the form","                    for (var i = 0; i < childs.length; i += 1) {","                        childInputs[i] = {","                            ele: childs[i],","                            parent: childs[i].up()","                        };","                        childs[i].remove();","                    }","                    //add previous input elements to form","                    //Text inputs","                    for (var i = 0; i < this.childInputs.length; i += 1) {","                        this.childInputs[i].ele.style.display = 'none';","                        this.currentForm.insert(this.childInputs[i].ele);","                    }","","","                    //And embedded data","                    for (var key in this.tempED) {","                        if (this.tempED.hasOwnProperty(key)) {","                            QRTEController.setEmbeddedData(key, this.tempED[key]);","                        }","                    }","                    //Reset stored embedded data","                    this.tempED = {};","                    //set new childs","                    this.childInputs = childInputs;","","                    //Loop over submit stack, or callbacks that need to be finished before submitting","                    for (var i = 0; i < QRTEController.onSubmitStack.length; i += 1) {","                        QRTE.onSubmitStack[i]();","                    }","                    QRTEController.onSubmitStack = [];","                    ","                    ","                    Page.adapter.next(Page.serializePageRuntime()).then(function(data) {QRTEController.requestNextTrialCallback(data)})","","                    //Set server comm onset for the next trial","                    QRTE.setBlockData('ServerCommOnset', window.requestAnimationFrame.now());","","                    QRTEController.betweenSubmits = true;","","                    for (var i = 0; i < this.childInputs.length; i += 1) {","                        this.childInputs[i].parent.insert(this.childInputs[i].ele);","                        this.childInputs[i].ele.style.display = 'none';","                    }","                } else if (isLastTrial === true) {","                    //Just add the previous trial's childInputs to the form ","                    for (var i = 0; i < this.childInputs.length; i += 1) {","","                        this.currentForm.insert(this.childInputs[i].ele);","                        this.childInputs[i].ele.style.display = 'none';","                    }","","                    this.loadNextTrial = function() {","                        //Directly submitting the form doesn't seem to work? Let's do it through NextButton click","                        $('NextButton').click();","                    };","                }","            },","","            loadNextTrial: function() {","                if (this.handlingSubmit === true) {","                    //The submit still hasn't returned..","                    this.loadUponCallback = true;","                    return;","","                }","                //Set handling submit to false (as page has been returned)","                //Save the previous form","                this.previousForm = this.currentForm;","                //Reset the QuestionInfo object, this is for Qualtrics to correctly initiate its own page","                Qualtrics.SurveyEngine.QuestionInfo = {}","                ","                /** Load template into Qualtrics Page","                */","                ","                    //Parse the HTML that was returned earlier and set it as the current trial container's contents","                Page._renderPageTemplate(this.nextTrialText,\"next\"); //this.nextTrialContainer = jQuery(this.nextTrialContainer).html(this.nextTrialText)[0];","                //Filter out the 'form' field, and append it back.","                ","                this.currentForm = jQuery('form')[0];","                jQuery(this.previousForm).replaceWith(jQuery(this.currentForm));","","                jQuery(this.currentForm).show();","                if (this.currentForm.select('.END_OF_SURVEY').length === 0) {","                    this.currentForm.fire('QRTE:load');","                    this.submitPage = this.requestNextTrial;","                } else {","                    this.submitPage = this.currentForm.submit;","                }","","            },","","            requestNextTrialCallback: function(e) {","                QRTEController.nextTrialText = e;","                QRTEController.handlingSubmit = false;","                QRTE.setBlockData('ServerCommOffset', window.requestAnimationFrame.now())"]},{"start":{"row":1438,"column":4},"end":{"row":1448,"column":152},"action":"insert","lines":["//If preview mode is run (PreviewBanner element exists, add a QRTEngine plug with id QRTEPlug)","","    if ($('PreviewBanner')) {","        var plug, row, banner = $('PreviewBanner');","        //Go down to the first table row inside that banner","        row = banner.children[0].children[0].children[0];","        //Insert new cell    ","        plug = row.insertCell(2);","        plug.id = \"QRTEPlug\";","        plug.width = \"20%\";","        plug.innerHTML = 'This survey is proudly and successfully powered by <a href=\"http://qrtengine.com\" target=\"_blank\"><i><b>QRTEngine</b></i></a>'"]},{"start":{"row":1449,"column":0},"end":{"row":1450,"column":0},"action":"remove","lines":["",""]},{"start":{"row":1449,"column":8},"end":{"row":1491,"column":4},"action":"remove","lines":["        if (QRTEController.loadUponCallback === true) {","                    QRTEController.loadUponCallback = false;","                    QRTEController.loadNextTrial();","                }","            },","","            submitPage: function() {","                console.log('Not yet initialised');","            },","","            count: function(obj) {","                var count = 0;","","                for (var prop in obj) {","                    if (obj.hasOwnProperty(prop))","                        ++count;","                }","","                return count;","            },","","            BDCache: {},","            storeBlockData: function(blockData) {","                this.BDCache = blockData;","            },","","            loadBlockData: function() {","                return this.BDCache;","            }","        };","        ","        ","        if(document.readyState === \"complete\" && QRTEController.inited === false) {","          //Already loaded!","          QRTEController.init();","        }","        else {","            document.observe('dom:loaded', QRTEController.init.bind(QRTEController));","        }","","","","    "]},{"start":{"row":1449,"column":8},"end":{"row":1453,"column":0},"action":"insert","lines":["plug.style.textAlign = \"center\";","    }","</script>","<script>",""]},{"start":{"row":1454,"column":0},"end":{"row":1454,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1455,"column":8},"end":{"row":1455,"column":10},"action":"remove","lines":["  "]},{"start":{"row":1455,"column":8},"end":{"row":1455,"column":10},"action":"remove","lines":["  "]},{"start":{"row":1456,"column":0},"end":{"row":1456,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1457,"column":12},"end":{"row":1457,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1458,"column":8},"end":{"row":1458,"column":9},"action":"remove","lines":[" "]},{"start":{"row":1458,"column":8},"end":{"row":1459,"column":4},"action":"remove","lines":["   };","    "]},{"start":{"row":1458,"column":8},"end":{"row":1459,"column":0},"action":"insert","lines":["};",""]},{"start":{"row":1460,"column":8},"end":{"row":1460,"column":11},"action":"remove","lines":["   "]},{"start":{"row":1460,"column":8},"end":{"row":1460,"column":9},"action":"remove","lines":[" "]},{"start":{"row":1461,"column":0},"end":{"row":1461,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1462,"column":12},"end":{"row":1462,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1463,"column":12},"end":{"row":1463,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1463,"column":12},"end":{"row":1463,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1464,"column":0},"end":{"row":1464,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1465,"column":0},"end":{"row":1465,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1466,"column":8},"end":{"row":1467,"column":4},"action":"remove","lines":["    }","    "]},{"start":{"row":1466,"column":8},"end":{"row":1467,"column":0},"action":"insert","lines":["}",""]},{"start":{"row":1468,"column":12},"end":{"row":1468,"column":15},"action":"remove","lines":["   "]},{"start":{"row":1468,"column":12},"end":{"row":1468,"column":13},"action":"remove","lines":[" "]},{"start":{"row":1469,"column":0},"end":{"row":1469,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1470,"column":12},"end":{"row":1470,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1471,"column":12},"end":{"row":1471,"column":13},"action":"remove","lines":[" "]},{"start":{"row":1471,"column":12},"end":{"row":1471,"column":15},"action":"remove","lines":["   "]},{"start":{"row":1472,"column":16},"end":{"row":1472,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1473,"column":0},"end":{"row":1473,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1474,"column":20},"end":{"row":1474,"column":24},"action":"remove","lines":["    "]},{"start":{"row":1475,"column":20},"end":{"row":1475,"column":24},"action":"remove","lines":["    "]},{"start":{"row":1476,"column":16},"end":{"row":1476,"column":18},"action":"remove","lines":["  "]},{"start":{"row":1476,"column":16},"end":{"row":1477,"column":4},"action":"remove","lines":["  }","    "]},{"start":{"row":1476,"column":16},"end":{"row":1477,"column":0},"action":"insert","lines":["}",""]},{"start":{"row":1478,"column":0},"end":{"row":1478,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1479,"column":16},"end":{"row":1479,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1479,"column":16},"end":{"row":1479,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1480,"column":0},"end":{"row":1480,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1481,"column":16},"end":{"row":1481,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1481,"column":16},"end":{"row":1481,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1482,"column":0},"end":{"row":1482,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1483,"column":20},"end":{"row":1483,"column":24},"action":"remove","lines":["    "]},{"start":{"row":1484,"column":20},"end":{"row":1484,"column":21},"action":"remove","lines":[" "]},{"start":{"row":1484,"column":20},"end":{"row":1484,"column":23},"action":"remove","lines":["   "]},{"start":{"row":1485,"column":0},"end":{"row":1485,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1486,"column":24},"end":{"row":1486,"column":27},"action":"remove","lines":["   "]},{"start":{"row":1486,"column":24},"end":{"row":1486,"column":25},"action":"remove","lines":[" "]},{"start":{"row":1487,"column":0},"end":{"row":1487,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1488,"column":0},"end":{"row":1521,"column":0},"action":"remove","lines":["                        }","                    };","                    timer = setTimeout(fire, nextFrame);","                };","            }","            requestAnimationFrame(function(time) {","                var _ref1;","                if ((((_ref1 = window.performance) != null ? _ref1.now : void 0) != null) && time < 1e12) {","                    requestAnimationFrame.now = function() {","                        return window.performance.now() + window.performance.timing.navigationStart;","                    };","                    requestAnimationFrame.method = 'native-highres';","                } else {","                    requestAnimationFrame.now = now;","                }","            });","            requestAnimationFrame.now = ((_ref1 = window.performance) != null ? _ref1.now : void 0) != null ? (function() {","                return window.performance.now() + window.performance.timing.navigationStart;","            }) : now;","            requestAnimationFrame.method = method;","            window.requestAnimationFrame = requestAnimationFrame;","        })();","","        function loadScript(url, callback) {","","            var script = document.createElement(\"script\")","            script.type = \"text/javascript\";","","            if (script.readyState) { //IE","                script.onreadystatechange = function() {","                    if (script.readyState == \"loaded\" || script.readyState == \"complete\") {","                        script.onreadystatechange = null;","                        callback();",""]},{"start":{"row":1489,"column":0},"end":{"row":1490,"column":0},"action":"remove","lines":["",""]},{"start":{"row":1490,"column":12},"end":{"row":1493,"column":3},"action":"remove","lines":["} else { //Others","                script.onload = function() {","                    callback();","   "]},{"start":{"row":1490,"column":12},"end":{"row":1491,"column":0},"action":"insert","lines":["    timer = setTimeout(fire, nextFrame);",""]},{"start":{"row":1491,"column":12},"end":{"row":1491,"column":13},"action":"remove","lines":[" "]},{"start":{"row":1492,"column":8},"end":{"row":1493,"column":0},"action":"remove","lines":["    }",""]},{"start":{"row":1492,"column":8},"end":{"row":1492,"column":9},"action":"insert","lines":["}"]},{"start":{"row":1493,"column":8},"end":{"row":1507,"column":14},"action":"remove","lines":["    script.src = url;","            document.getElementsByTagName(\"head\")[0].appendChild(script);","        }","","        (function() {","","            //jQuery is only required for the Fixation flash fix. prototypejs is unable to efficiently replace elements","            //and introduces a 10 ms delay between loading element and firing off the scripts. Unacceptable","            //First time jQuery should be used is the second trial","","            loadScript(\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\", function() {","","                $.noConflict();","","            })"]},{"start":{"row":1493,"column":8},"end":{"row":1498,"column":17},"action":"insert","lines":["requestAnimationFrame(function(time) {","            var _ref1;","            if ((((_ref1 = window.performance) != null ? _ref1.now : void 0) != null) && time < 1e12) {","                requestAnimationFrame.now = function() {","                    return window.performance.now() + window.performance.timing.navigationStart;","                }"]},{"start":{"row":1499,"column":0},"end":{"row":1500,"column":0},"action":"remove","lines":["",""]},{"start":{"row":1499,"column":8},"end":{"row":1501,"column":0},"action":"remove","lines":["})();","",""]},{"start":{"row":1499,"column":16},"end":{"row":1505,"column":29},"action":"remove","lines":["//If preview mode is run (PreviewBanner element exists, add a QRTEngine plug with id QRTEPlug)","","        if ($('PreviewBanner')) {","            var plug, row, banner = $('PreviewBanner');","            //Go down to the first table row inside that banner","            row = banner.children[0].children[0].children[0];","            //Insert new cell"]},{"start":{"row":1499,"column":16},"end":{"row":1504,"column":2},"action":"insert","lines":["requestAnimationFrame.method = 'native-highres';","            }","            else {","                requestAnimationFrame.now = now;","            }","  "]},{"start":{"row":1504,"column":6},"end":{"row":1505,"column":1},"action":"remove","lines":[""," "]},{"start":{"row":1504,"column":8},"end":{"row":1505,"column":0},"action":"insert","lines":["});",""]},{"start":{"row":1505,"column":8},"end":{"row":1510,"column":9},"action":"remove","lines":[" plug = row.insertCell(2);","            plug.id = \"QRTEPlug\";","            plug.width = \"20%\";","            plug.innerHTML = 'This survey is proudly and successfully powered by <a href=\"http://qrtengine.com\" target=\"_blank\"><i><b>QRTEngine</b></i></a>';","            plug.style.textAlign = \"center\";","        }"]},{"start":{"row":1505,"column":8},"end":{"row":1509,"column":61},"action":"insert","lines":["requestAnimationFrame.now = ((_ref1 = window.performance) != null ? _ref1.now : void 0) != null ? (function() {","            return window.performance.now() + window.performance.timing.navigationStart;","        }) : now;","        requestAnimationFrame.method = method;","        window.requestAnimationFrame = requestAnimationFrame;"]},{"start":{"row":1510,"column":5},"end":{"row":1510,"column":9},"action":"insert","lines":[")();"]},{"start":{"row":1513,"column":17},"end":{"row":1513,"column":20},"action":"remove","lines":["tru"]},{"start":{"row":1513,"column":17},"end":{"row":1513,"column":21},"action":"insert","lines":["fals"]},{"start":{"row":1519,"column":16},"end":{"row":1519,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1522,"column":16},"end":{"row":1522,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1525,"column":16},"end":{"row":1525,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1528,"column":15},"end":{"row":1528,"column":16},"action":"remove","lines":[" "]},{"start":{"row":1531,"column":15},"end":{"row":1531,"column":16},"action":"remove","lines":[" "]},{"start":{"row":1532,"column":16},"end":{"row":1532,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1534,"column":15},"end":{"row":1534,"column":16},"action":"remove","lines":[" "]},{"start":{"row":1543,"column":15},"end":{"row":1543,"column":16},"action":"remove","lines":[" "]},{"start":{"row":1544,"column":19},"end":{"row":1544,"column":20},"action":"remove","lines":[" "]},{"start":{"row":1547,"column":19},"end":{"row":1547,"column":20},"action":"remove","lines":[" "]},{"start":{"row":1559,"column":21},"end":{"row":1563,"column":18},"action":"remove","lines":[" !important;","    }","    #SkinContent > #Buttons,","    .SkinInner > #Header {","        padding: 0"]}],[{"start":{"row":311,"column":12},"end":{"row":311,"column":13},"action":"insert","lines":["/"],"id":9614}],[{"start":{"row":311,"column":13},"end":{"row":311,"column":14},"action":"insert","lines":["/"],"id":9615}],[{"start":{"row":1189,"column":10},"end":{"row":1207,"column":10},"action":"remove","lines":["","","        fixSetEmbeddedDataBug: function() {","            Qualtrics.SurveyEngine.setEmbeddedData = function(key, value) {","                var fieldName = 'ED~' + key;","                if ($(fieldName)) {","                    $(fieldName).value = value;","                }","                else {","                    $('Header').appendChild(QBuilder('input', {","                        type: 'hidden',","                        id: fieldName,","                        name: fieldName,","                        value: value","                    }));","                    Qualtrics.SurveyEngine.setEmbeddedData(key, value);","                }","            }","        },"],"id":9616}],[{"start":{"row":10,"column":38},"end":{"row":10,"column":39},"action":"insert","lines":["_"],"id":9617}],[{"start":{"row":10,"column":39},"end":{"row":10,"column":40},"action":"insert","lines":["j"],"id":9618}],[{"start":{"row":2,"column":23},"end":{"row":2,"column":24},"action":"insert","lines":["_"],"id":9620}],[{"start":{"row":2,"column":24},"end":{"row":2,"column":25},"action":"insert","lines":["j"],"id":9621}],[{"start":{"row":2,"column":25},"end":{"row":2,"column":26},"action":"insert","lines":["f"],"id":9622}],[{"start":{"row":2,"column":26},"end":{"row":2,"column":27},"action":"insert","lines":["e"],"id":9623}],[{"start":{"row":2,"column":27},"end":{"row":2,"column":28},"action":"insert","lines":["_"],"id":9624}],[{"start":{"row":2,"column":28},"end":{"row":2,"column":29},"action":"insert","lines":["f"],"id":9625}],[{"start":{"row":2,"column":29},"end":{"row":2,"column":30},"action":"insert","lines":["i"],"id":9626}],[{"start":{"row":2,"column":30},"end":{"row":2,"column":31},"action":"insert","lines":["x"],"id":9627}],[{"start":{"row":2,"column":22},"end":{"row":2,"column":23},"action":"remove","lines":["5"],"id":9628,"ignore":true},{"start":{"row":2,"column":22},"end":{"row":2,"column":23},"action":"insert","lines":["7"]},{"start":{"row":4,"column":21},"end":{"row":4,"column":26},"action":"insert","lines":["-2014"]},{"start":{"row":10,"column":38},"end":{"row":10,"column":40},"action":"remove","lines":["_j"]},{"start":{"row":32,"column":0},"end":{"row":32,"column":31},"action":"insert","lines":["        version: 'v17_jfe_fix',"]},{"start":{"row":41,"column":10},"end":{"row":41,"column":11},"action":"remove","lines":[" "]},{"start":{"row":108,"column":52},"end":{"row":108,"column":53},"action":"remove","lines":[" "]},{"start":{"row":116,"column":48},"end":{"row":116,"column":49},"action":"remove","lines":[" "]},{"start":{"row":122,"column":0},"end":{"row":123,"column":0},"action":"insert","lines":["            //Store value in trial cache",""]},{"start":{"row":125,"column":0},"end":{"row":126,"column":0},"action":"insert","lines":["                //Add column to overall trial data",""]},{"start":{"row":141,"column":48},"end":{"row":141,"column":49},"action":"remove","lines":[" "]},{"start":{"row":152,"column":56},"end":{"row":152,"column":57},"action":"remove","lines":[" "]},{"start":{"row":169,"column":0},"end":{"row":171,"column":0},"action":"insert","lines":["            //Store blockData in ED so that we can use it next trial","            QRTEController.storeBlockData(QRTE.BDCache);",""]},{"start":{"row":177,"column":65},"end":{"row":177,"column":66},"action":"remove","lines":[" "]},{"start":{"row":199,"column":0},"end":{"row":200,"column":0},"action":"insert","lines":["            //This only works if the Survey Data has been set during the same trial due to a bug in Qualtrics.",""]},{"start":{"row":216,"column":13},"end":{"row":217,"column":11},"action":"remove","lines":["","           "]},{"start":{"row":237,"column":13},"end":{"row":238,"column":11},"action":"remove","lines":["","           "]},{"start":{"row":296,"column":0},"end":{"row":314,"column":0},"action":"insert","lines":["        /** ","         * Wait for images to load before starting trial.","         * @property waitForImageLoad","         * @private","         * @type Boolean","         */","","        waitForImageLoad: true,","","        /** ","         * Trial Start waiting list - initialised with waiting for TrialStart","         * @property loadWaitingList","         * @private","         * @type Array","         */","","        loadWaitingList: [false],","",""]},{"start":{"row":327,"column":31},"end":{"row":327,"column":82},"action":"remove","lines":["DataString, blockId, columns, idData, exitQuestions"]},{"start":{"row":327,"column":31},"end":{"row":327,"column":33},"action":"insert","lines":["Id"]},{"start":{"row":332,"column":12},"end":{"row":332,"column":14},"action":"remove","lines":["//"]},{"start":{"row":333,"column":0},"end":{"row":338,"column":0},"action":"insert","lines":["            //Initialise block Data","            blockDataString = Qualtrics.SurveyEngine.getEmbeddedData(this.blockDataField)|| '';","            columns = Qualtrics.SurveyEngine.getEmbeddedData(this.columnsField)|| '';","            idData = Qualtrics.SurveyEngine.getEmbeddedData(this.idField)|| '';","            exitQuestions = Qualtrics.SurveyEngine.getEmbeddedData(this.exitQuestions)|| '';",""]},{"start":{"row":343,"column":27},"end":{"row":343,"column":56},"action":"insert","lines":["QRTEController.loadBlockData("]},{"start":{"row":343,"column":71},"end":{"row":343,"column":81},"action":"remove","lines":[".evalJSON("]},{"start":{"row":346,"column":0},"end":{"row":347,"column":0},"action":"insert","lines":["                //If this is a new block, initialise a new block",""]},{"start":{"row":358,"column":0},"end":{"row":359,"column":0},"action":"insert","lines":["                //And update the exit questions",""]},{"start":{"row":373,"column":0},"end":{"row":383,"column":0},"action":"remove","lines":["            QRTE.log(QRTE.SDCache);","        },","        ","        deepClone: function(ele) {","           var clone = ele.clone();","           var children = ele.children;","           for(var i = 0; i < children.length; i += 1) {","               clone.appendChild(QRTE.deepClone(children[i]));","           }","           return  clone; ",""]},{"start":{"row":388,"column":0},"end":{"row":389,"column":0},"action":"insert","lines":["         *  @param [paramObj.waitForImages] {Boolean} Specify whether we should wait for images or not. Is on by default, but could be turned off if all images are pre-loaded in cache, or are very small in general.",""]},{"start":{"row":392,"column":14},"end":{"row":393,"column":0},"action":"remove","lines":["Quickly Hide the Questions in the Survey",""]},{"start":{"row":392,"column":14},"end":{"row":392,"column":30},"action":"insert","lines":["init the library"]},{"start":{"row":394,"column":0},"end":{"row":395,"column":0},"action":"insert","lines":["",""]},{"start":{"row":395,"column":14},"end":{"row":414,"column":15},"action":"remove","lines":["QRTE.removeSeparators();","","            QRTE.initIndex = paramObj.initQuestionIndex - 1 || 0;","            ","            //UNCOMMENT","            //QRTE.debugFirst = QRTE.deepClone($$('.Skin')[0]);","","            validationArray = [{","                name: 'blockData',","                type: ['JSON', 'Empty'],","                required: true","            }, {","                name: 'columnData',","                type: ['JSON', 'Empty'],","                required: true","            }, {","                name: 'idData',","                type: ['JSON', 'Empty'],","                required: true","            }, "]},{"start":{"row":395,"column":14},"end":{"row":399,"column":31},"action":"insert","lines":["set the initIndex (if the Init question is not the first question of the block)","            QRTE.initIndex = paramObj.initQuestionIndex - 1 || 0;","","","            validationArray = ["]},{"start":{"row":412,"column":27},"end":{"row":412,"column":36},"action":"remove","lines":["Questions"]},{"start":{"row":412,"column":27},"end":{"row":412,"column":34},"action":"insert","lines":["ItemTag"]},{"start":{"row":416,"column":23},"end":{"row":416,"column":34},"action":"remove","lines":["exitItemTag"]},{"start":{"row":416,"column":23},"end":{"row":416,"column":36},"action":"insert","lines":["waitForImages"]},{"start":{"row":417,"column":24},"end":{"row":417,"column":30},"action":"remove","lines":["String"]},{"start":{"row":417,"column":24},"end":{"row":417,"column":31},"action":"insert","lines":["Boolean"]},{"start":{"row":418,"column":26},"end":{"row":418,"column":29},"action":"remove","lines":["tru"]},{"start":{"row":418,"column":26},"end":{"row":418,"column":30},"action":"insert","lines":["fals"]},{"start":{"row":424,"column":0},"end":{"row":425,"column":0},"action":"insert","lines":["",""]},{"start":{"row":426,"column":39},"end":{"row":426,"column":43},"action":"remove","lines":["Data"]},{"start":{"row":426,"column":39},"end":{"row":426,"column":41},"action":"insert","lines":["Id"]},{"start":{"row":426,"column":52},"end":{"row":427,"column":0},"action":"remove","lines":["blockId, paramObj.columnData, paramObj.idData, paramObj.exitQuestions, paramObj.exitItemTag);",""]},{"start":{"row":426,"column":52},"end":{"row":431,"column":13},"action":"insert","lines":["exitItemTag);","","","            if (paramObj.waitForImages !== undefined) {","                QRTE.waitForImageLoad = paramObj.waitForImages;","            }"]},{"start":{"row":434,"column":0},"end":{"row":435,"column":0},"action":"insert","lines":["",""]},{"start":{"row":472,"column":13},"end":{"row":473,"column":11},"action":"remove","lines":["","           "]},{"start":{"row":473,"column":61},"end":{"row":473,"column":62},"action":"remove","lines":[" "]},{"start":{"row":491,"column":0},"end":{"row":494,"column":0},"action":"insert","lines":["         *  @param [paramObj.onHideFn] {Function} Function to be called upon Stimulus being hidden","         *  @param [paramObj.duringDisplayFn] {Function} Function to be called during each frame that the Stimulus is being displayed","         ",""]},{"start":{"row":540,"column":0},"end":{"row":544,"column":0},"action":"insert","lines":["            }, {","                name: 'onHideFn',","                type: ['Function'],","                required: false",""]},{"start":{"row":555,"column":0},"end":{"row":556,"column":0},"action":"remove","lines":["            QRTE.log(paramObj.conditional);",""]},{"start":{"row":568,"column":0},"end":{"row":569,"column":0},"action":"remove","lines":["                this.hideChoices();",""]},{"start":{"row":573,"column":0},"end":{"row":575,"column":0},"action":"insert","lines":["                    duringDisplayFn: paramObj.duringDisplayFn,","                    onHideFn: paramObj.onHideFn,",""]},{"start":{"row":579,"column":0},"end":{"row":580,"column":0},"action":"remove","lines":["                    duringDisplayFn: paramObj.duringDisplayFn,",""]},{"start":{"row":596,"column":0},"end":{"row":597,"column":12},"action":"remove","lines":["            ","            "]},{"start":{"row":596,"column":0},"end":{"row":597,"column":0},"action":"insert","lines":["",""]},{"start":{"row":621,"column":93},"end":{"row":622,"column":74},"action":"insert","lines":["","                    QRTE.setTrialData('QRTEngine[Version]', QRTE.version);"]},{"start":{"row":627,"column":24},"end":{"row":627,"column":26},"action":"insert","lines":["//"]},{"start":{"row":653,"column":20},"end":{"row":653,"column":30},"action":"remove","lines":["this.click"]},{"start":{"row":653,"column":20},"end":{"row":656,"column":23},"action":"insert","lines":["//QRTE.submitPage();","                    //QRTEController.loadNextTrial();","                    ","                    $('"]},{"start":{"row":656,"column":33},"end":{"row":656,"column":41},"action":"insert","lines":["').click"]},{"start":{"row":670,"column":32},"end":{"row":670,"column":33},"action":"insert","lines":["0"]},{"start":{"row":673,"column":0},"end":{"row":674,"column":0},"action":"insert","lines":["",""]},{"start":{"row":674,"column":12},"end":{"row":674,"column":14},"action":"remove","lines":["//"]},{"start":{"row":674,"column":17},"end":{"row":674,"column":62},"action":"remove","lines":["debugSecond = QRTE.deepClone($$('.Skin')[0]);"]},{"start":{"row":674,"column":17},"end":{"row":691,"column":0},"action":"insert","lines":["loadWaitingList = [false];","            if (QRTE.waitForImageLoad === true) {","                //set wait for image load queues.","                var loadIndex = 1,","                    images = $$('.QuestionOuter img'),","                    i = 0;","","                var l = images.length;","                for (; i < l; i += 1) {","                    images[i].observe('load', function(e) {","                        QRTE.startTrial(e.target.QRTELoadIndex);","                    })","                    images[i].QRTELoadIndex = i + 1;","                    QRTE.loadWaitingList[i + 1] = false;","                }","","            }",""]},{"start":{"row":714,"column":29},"end":{"row":714,"column":36},"action":"insert","lines":["startId"]},{"start":{"row":719,"column":0},"end":{"row":725,"column":0},"action":"insert","lines":["            QRTE.loadWaitingList[startId] = true;","            if (!QRTE.loadWaitingList.every()) {","                QRTE.log('Process ' + startId + 'finished, waiting for other processes to finish')","                return;","            }","",""]},{"start":{"row":729,"column":0},"end":{"row":730,"column":0},"action":"remove","lines":["            //QRTE.debugThird = QRTE.deepClone($$('.Skin')[0]);",""]},{"start":{"row":739,"column":0},"end":{"row":740,"column":0},"action":"insert","lines":["                    //Get current time, required for ",""]},{"start":{"row":743,"column":35},"end":{"row":745,"column":28},"action":"remove","lines":["","                    /*var sum = 0,","                        i;*/"]},{"start":{"row":754,"column":13},"end":{"row":755,"column":11},"action":"remove","lines":["","           "]},{"start":{"row":772,"column":0},"end":{"row":786,"column":0},"action":"insert","lines":["            QRTE.inited = true;","","            //Set initial trial data related to loading of this trial","            QRTE.setTrialData('InitServerComm[Onset]', QRTE.getBlockData('ServerCommOnset'));","            QRTE.setTrialData('InitServerComm[Offset]', QRTE.getBlockData('ServerCommOffset'));","            QRTE.setTrialData('InitServerComm[CalculatedDuration]', QRTE.getBlockData('ServerCommOffset') - QRTE.getBlockData('ServerCommOnset'));","","            //<Load next trial here>","            var currentLoops = '${lm://CurrentLoopNumber}',","                totalLoops = '${lm://TotalLoops}';","            //Check if last trial, currentloops === totalLoops;","            ","            //QRTEController.requestNextTrial(currentLoops !== '' && currentLoops === totalLoops);","",""]},{"start":{"row":849,"column":75},"end":{"row":849,"column":76},"action":"remove","lines":[" "]},{"start":{"row":863,"column":0},"end":{"row":864,"column":0},"action":"remove","lines":["",""]},{"start":{"row":907,"column":29},"end":{"row":908,"column":27},"action":"remove","lines":["","                           "]},{"start":{"row":919,"column":25},"end":{"row":920,"column":23},"action":"remove","lines":["","                       "]},{"start":{"row":955,"column":57},"end":{"row":956,"column":35},"action":"insert","lines":[",","                    id: question.id"]},{"start":{"row":1062,"column":12},"end":{"row":1062,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1063,"column":0},"end":{"row":1063,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1064,"column":20},"end":{"row":1064,"column":23},"action":"insert","lines":["   "]},{"start":{"row":1064,"column":23},"end":{"row":1064,"column":24},"action":"insert","lines":[" "]},{"start":{"row":1065,"column":0},"end":{"row":1065,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1066,"column":16},"end":{"row":1066,"column":20},"action":"insert","lines":["    "]},{"start":{"row":1067,"column":16},"end":{"row":1067,"column":17},"action":"insert","lines":[" "]},{"start":{"row":1067,"column":17},"end":{"row":1067,"column":20},"action":"insert","lines":["   "]},{"start":{"row":1068,"column":0},"end":{"row":1068,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1069,"column":0},"end":{"row":1069,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1070,"column":16},"end":{"row":1070,"column":20},"action":"insert","lines":["    "]},{"start":{"row":1071,"column":0},"end":{"row":1071,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1072,"column":16},"end":{"row":1072,"column":18},"action":"insert","lines":["  "]},{"start":{"row":1072,"column":18},"end":{"row":1072,"column":20},"action":"insert","lines":["  "]},{"start":{"row":1073,"column":16},"end":{"row":1073,"column":20},"action":"insert","lines":["    "]},{"start":{"row":1074,"column":0},"end":{"row":1074,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1075,"column":16},"end":{"row":1075,"column":17},"action":"insert","lines":[" "]},{"start":{"row":1075,"column":17},"end":{"row":1075,"column":20},"action":"insert","lines":["   "]},{"start":{"row":1076,"column":16},"end":{"row":1076,"column":20},"action":"insert","lines":["    "]},{"start":{"row":1077,"column":12},"end":{"row":1077,"column":15},"action":"insert","lines":["   "]},{"start":{"row":1077,"column":15},"end":{"row":1077,"column":16},"action":"insert","lines":[" "]},{"start":{"row":1078,"column":0},"end":{"row":1078,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1079,"column":16},"end":{"row":1079,"column":20},"action":"insert","lines":["    "]},{"start":{"row":1080,"column":12},"end":{"row":1080,"column":14},"action":"insert","lines":["  "]},{"start":{"row":1080,"column":14},"end":{"row":1080,"column":16},"action":"insert","lines":["  "]},{"start":{"row":1081,"column":0},"end":{"row":1081,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1082,"column":0},"end":{"row":1082,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1164,"column":16},"end":{"row":1164,"column":39},"action":"remove","lines":["console.log(arguments);"]},{"start":{"row":1164,"column":16},"end":{"row":1166,"column":17},"action":"insert","lines":["for (var i = 0; i < arguments.length; i += 1) {","                    console.log(arguments[i]);","                }"]},{"start":{"row":1224,"column":12},"end":{"row":1224,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1225,"column":0},"end":{"row":1225,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1226,"column":0},"end":{"row":1226,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1227,"column":16},"end":{"row":1227,"column":20},"action":"insert","lines":["    "]},{"start":{"row":1228,"column":12},"end":{"row":1228,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1229,"column":16},"end":{"row":1229,"column":19},"action":"insert","lines":["   "]},{"start":{"row":1229,"column":19},"end":{"row":1229,"column":20},"action":"insert","lines":[" "]},{"start":{"row":1230,"column":12},"end":{"row":1230,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1231,"column":16},"end":{"row":1231,"column":17},"action":"insert","lines":[" "]},{"start":{"row":1231,"column":17},"end":{"row":1231,"column":20},"action":"insert","lines":["   "]},{"start":{"row":1232,"column":12},"end":{"row":1232,"column":14},"action":"insert","lines":["  "]},{"start":{"row":1232,"column":14},"end":{"row":1232,"column":16},"action":"insert","lines":["  "]},{"start":{"row":1233,"column":0},"end":{"row":1233,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1234,"column":12},"end":{"row":1234,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1235,"column":16},"end":{"row":1235,"column":17},"action":"insert","lines":[" "]},{"start":{"row":1235,"column":17},"end":{"row":1235,"column":20},"action":"insert","lines":["   "]},{"start":{"row":1236,"column":12},"end":{"row":1236,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1237,"column":0},"end":{"row":1237,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1238,"column":12},"end":{"row":1238,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1239,"column":0},"end":{"row":1239,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1240,"column":12},"end":{"row":1240,"column":15},"action":"insert","lines":["   "]},{"start":{"row":1240,"column":15},"end":{"row":1240,"column":16},"action":"insert","lines":[" "]},{"start":{"row":1241,"column":0},"end":{"row":1241,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1245,"column":0},"end":{"row":1262,"column":0},"action":"insert","lines":["        fixSetEmbeddedDataBug: function() {","            Qualtrics.SurveyEngine.setEmbeddedData = function(key, value) {","                var fieldName = 'ED~' + key;","                if ($(fieldName)) {","                    $(fieldName).value = value;","                } else {","                    $('Header').appendChild(QBuilder('input', {","                        type: 'hidden',","                        id: fieldName,","                        name: fieldName,","                        value: value","                    }));","                    Qualtrics.SurveyEngine.setEmbeddedData(key, value);","                }","            }","        },","",""]},{"start":{"row":1295,"column":13},"end":{"row":1296,"column":11},"action":"remove","lines":["","           "]},{"start":{"row":1313,"column":20},"end":{"row":1313,"column":55},"action":"insert","lines":["QRTE.proceedOnFrameEnd === true || "]},{"start":{"row":1316,"column":17},"end":{"row":1317,"column":15},"action":"remove","lines":["","               "]},{"start":{"row":1330,"column":17},"end":{"row":1331,"column":15},"action":"remove","lines":["","               "]},{"start":{"row":1341,"column":15},"end":{"row":1341,"column":16},"action":"insert","lines":["("]},{"start":{"row":1341,"column":65},"end":{"row":1341,"column":90},"action":"insert","lines":[" && QRTE.inited === true)"]},{"start":{"row":1355,"column":13},"end":{"row":1356,"column":11},"action":"remove","lines":["","           "]},{"start":{"row":1382,"column":12},"end":{"row":1382,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1383,"column":12},"end":{"row":1383,"column":14},"action":"insert","lines":["//"]},{"start":{"row":1387,"column":0},"end":{"row":1389,"column":12},"action":"remove","lines":["            ","            ","            "]},{"start":{"row":1387,"column":0},"end":{"row":1389,"column":0},"action":"insert","lines":["","",""]},{"start":{"row":1396,"column":13},"end":{"row":1397,"column":11},"action":"remove","lines":["","           "]},{"start":{"row":1404,"column":0},"end":{"row":1404,"column":12},"action":"remove","lines":["            "]},{"start":{"row":1411,"column":12},"end":{"row":1411,"column":14},"action":"insert","lines":["//"]},{"start":{"row":1435,"column":0},"end":{"row":1435,"column":8},"action":"remove","lines":["        "]},{"start":{"row":1441,"column":8},"end":{"row":1441,"column":9},"action":"insert","lines":[" "]},{"start":{"row":1458,"column":0},"end":{"row":1458,"column":8},"action":"remove","lines":["        "]},{"start":{"row":1464,"column":8},"end":{"row":1464,"column":9},"action":"insert","lines":[" "]},{"start":{"row":1475,"column":58},"end":{"row":1475,"column":59},"action":"insert","lines":[" "]},{"start":{"row":1483,"column":9},"end":{"row":1483,"column":10},"action":"insert","lines":[","]},{"start":{"row":1486,"column":4},"end":{"row":1496,"column":152},"action":"remove","lines":["//If preview mode is run (PreviewBanner element exists, add a QRTEngine plug with id QRTEPlug)","","    if ($('PreviewBanner')) {","        var plug, row, banner = $('PreviewBanner');","        //Go down to the first table row inside that banner","        row = banner.children[0].children[0].children[0];","        //Insert new cell    ","        plug = row.insertCell(2);","        plug.id = \"QRTEPlug\";","        plug.width = \"20%\";","        plug.innerHTML = 'This survey is proudly and successfully powered by <a href=\"http://qrtengine.com\" target=\"_blank\"><i><b>QRTEngine</b></i></a>'"]},{"start":{"row":1486,"column":4},"end":{"row":1665,"column":89},"action":"insert","lines":["if (typeof QRTEController == 'undefined') {","        //QRTE SurveySlider controller layer","        //Takes care of progressing through the survey. Catches all qualtrics native ways of submitting the form and replaces that by","        //its own asynchronous ajax stuff.","        QRTEController = {","","","            //This plug-in to QRTEngine has been developed under the name SurveySlider","            // for general Qualtrics Surveys. It has been adapted to work with QRTEngine","            nextTrialContainer: null,","            nextTrialText: '',","            currentForm: null,","            previousForm: null,","            handlingSubmit: false,","            onSubmitStack: [],","            inited: false,","            childInputs: [],","            loadUponCallback: false,","            setEmbeddedData: function() {},","            tempED: {},","","","","            //Initialize thecontroller","            init: function() {","                this.nextTrialContainer = new Element('div', {","                    id: 'nextTrialContainer'","                });","                this.currentForm = $$('form')[0];","                //Catch submits and change it with our own submit function (which does AJAX submissions)","                //this.currentForm.observe('QRTE:submit', QRTE.handleSubmit);","                this.currentElements = $$('.QuestionOuter');","","                //Initial SSload firing","                Qualtrics.SurveyEngine.addOnload(function() {","                    QRTEController.currentForm.fire('QRTE:load');","                });","                //Change SurveyEngine.OnLoad to trigger on SSload, rather than page load","                Qualtrics.SurveyEngine.addOnload = function(e) {","                        var questions = $$('.QuestionOuter'),","                            currentCount = QRTEController.count(Qualtrics.SurveyEngine.QuestionInfo),","                            id = questions[currentCount - 1].id;","                        var t = new Qualtrics.SurveyEngine.QuestionData;","                        this.Page.once(\"preready\", function() {","                            try {","                                e.apply(t)","                            } catch (n) {","                                s.error(\"SE API Error: \", n, e)","                            }","                        })","                    }","                    //Set the Qualtrics setEmbeddedData to inside the QRTEController","                ","                // Overwrite Page.__advancePage","                advancePage = Page.__advancePage","                ","                Page.__advancePage = function(e,t,n) {","                    console.log(e,t,n)","                    advancePage.apply(Page,[e,t,n])","                }","                QRTEController.setEmbeddedData = Qualtrics.SurveyEngine.setEmbeddedData;","                Qualtrics.SurveyEngine.setEmbeddedData = function(key, value) {","                    QRTEController.tempED[key] = value;","                }","                this.submitPage = this.requestNextTrial;","                this.inited = true;","            },","","            /**","             * Requests the next trial from the Qualtrics server.","             *","             *","             */","            requestNextTrial: function(isLastTrial) {","","                //If this is the last trial of a block, DON'T request the next page, let qualtrics handle it themselves","                if (this.handlingSubmit === false && isLastTrial === false) {","                    //Load next trial means that current page is a trial and has been inited","                    //Need to remove relevant input elements from current form before submitting","                    //After that add them back","                    this.handlingSubmit = true","                    var childs = $$('form input[type=text]'),","                        childInputs = [];","                    //remove current input elements from the form","                    for (var i = 0; i < childs.length; i += 1) {","                        childInputs[i] = {","                            ele: childs[i],","                            parent: childs[i].up()","                        };","                        childs[i].remove();","                    }","                    //add previous input elements to form","                    //Text inputs","                    for (var i = 0; i < this.childInputs.length; i += 1) {","                        this.childInputs[i].ele.style.display = 'none';","                        this.currentForm.insert(this.childInputs[i].ele);","                    }","","","                    //And embedded data","                    for (var key in this.tempED) {","                        if (this.tempED.hasOwnProperty(key)) {","                            QRTEController.setEmbeddedData(key, this.tempED[key]);","                        }","                    }","                    //Reset stored embedded data","                    this.tempED = {};","                    //set new childs","                    this.childInputs = childInputs;","","                    //Loop over submit stack, or callbacks that need to be finished before submitting","                    for (var i = 0; i < QRTEController.onSubmitStack.length; i += 1) {","                        QRTE.onSubmitStack[i]();","                    }","                    QRTEController.onSubmitStack = [];","                    ","                    ","                    Page.adapter.next(Page.serializePageRuntime()).then(function(data) {QRTEController.requestNextTrialCallback(data)})","","                    //Set server comm onset for the next trial","                    QRTE.setBlockData('ServerCommOnset', window.requestAnimationFrame.now());","","                    QRTEController.betweenSubmits = true;","","                    for (var i = 0; i < this.childInputs.length; i += 1) {","                        this.childInputs[i].parent.insert(this.childInputs[i].ele);","                        this.childInputs[i].ele.style.display = 'none';","                    }","                } else if (isLastTrial === true) {","                    //Just add the previous trial's childInputs to the form ","                    for (var i = 0; i < this.childInputs.length; i += 1) {","","                        this.currentForm.insert(this.childInputs[i].ele);","                        this.childInputs[i].ele.style.display = 'none';","                    }","","                    this.loadNextTrial = function() {","                        //Directly submitting the form doesn't seem to work? Let's do it through NextButton click","                        $('NextButton').click();","                    };","                }","            },","","            loadNextTrial: function() {","                if (this.handlingSubmit === true) {","                    //The submit still hasn't returned..","                    this.loadUponCallback = true;","                    return;","","                }","                //Set handling submit to false (as page has been returned)","                //Save the previous form","                this.previousForm = this.currentForm;","                //Reset the QuestionInfo object, this is for Qualtrics to correctly initiate its own page","                Qualtrics.SurveyEngine.QuestionInfo = {}","                ","                /** Load template into Qualtrics Page","                */","                ","                    //Parse the HTML that was returned earlier and set it as the current trial container's contents","                Page._renderPageTemplate(this.nextTrialText,\"next\"); //this.nextTrialContainer = jQuery(this.nextTrialContainer).html(this.nextTrialText)[0];","                //Filter out the 'form' field, and append it back.","                ","                this.currentForm = jQuery('form')[0];","                jQuery(this.previousForm).replaceWith(jQuery(this.currentForm));","","                jQuery(this.currentForm).show();","                if (this.currentForm.select('.END_OF_SURVEY').length === 0) {","                    this.currentForm.fire('QRTE:load');","                    this.submitPage = this.requestNextTrial;","                } else {","                    this.submitPage = this.currentForm.submit;","                }","","            },","","            requestNextTrialCallback: function(e) {","                QRTEController.nextTrialText = e;","                QRTEController.handlingSubmit = false;","                QRTE.setBlockData('ServerCommOffset', window.requestAnimationFrame.now())"]},{"start":{"row":1666,"column":0},"end":{"row":1667,"column":0},"action":"insert","lines":["",""]},{"start":{"row":1667,"column":8},"end":{"row":1671,"column":0},"action":"remove","lines":["plug.style.textAlign = \"center\";","    }","</script>","<script>",""]},{"start":{"row":1667,"column":8},"end":{"row":1709,"column":4},"action":"insert","lines":["        if (QRTEController.loadUponCallback === true) {","                    QRTEController.loadUponCallback = false;","                    QRTEController.loadNextTrial();","                }","            },","","            submitPage: function() {","                console.log('Not yet initialised');","            },","","            count: function(obj) {","                var count = 0;","","                for (var prop in obj) {","                    if (obj.hasOwnProperty(prop))","                        ++count;","                }","","                return count;","            },","","            BDCache: {},","            storeBlockData: function(blockData) {","                this.BDCache = blockData;","            },","","            loadBlockData: function() {","                return this.BDCache;","            }","        };","        ","        ","        if(document.readyState === \"complete\" && QRTEController.inited === false) {","          //Already loaded!","          QRTEController.init();","        }","        else {","            document.observe('dom:loaded', QRTEController.init.bind(QRTEController));","        }","","","","    "]},{"start":{"row":1710,"column":0},"end":{"row":1710,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1711,"column":8},"end":{"row":1711,"column":10},"action":"insert","lines":["  "]},{"start":{"row":1711,"column":10},"end":{"row":1711,"column":12},"action":"insert","lines":["  "]},{"start":{"row":1712,"column":0},"end":{"row":1712,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1713,"column":12},"end":{"row":1713,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1714,"column":8},"end":{"row":1714,"column":9},"action":"insert","lines":[" "]},{"start":{"row":1714,"column":9},"end":{"row":1715,"column":0},"action":"remove","lines":["};",""]},{"start":{"row":1714,"column":9},"end":{"row":1715,"column":4},"action":"insert","lines":["   };","    "]},{"start":{"row":1716,"column":8},"end":{"row":1716,"column":11},"action":"insert","lines":["   "]},{"start":{"row":1716,"column":11},"end":{"row":1716,"column":12},"action":"insert","lines":[" "]},{"start":{"row":1717,"column":0},"end":{"row":1717,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1718,"column":12},"end":{"row":1718,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1719,"column":12},"end":{"row":1719,"column":14},"action":"insert","lines":["  "]},{"start":{"row":1719,"column":14},"end":{"row":1719,"column":16},"action":"insert","lines":["  "]},{"start":{"row":1720,"column":0},"end":{"row":1720,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1721,"column":0},"end":{"row":1721,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1722,"column":8},"end":{"row":1723,"column":0},"action":"remove","lines":["}",""]},{"start":{"row":1722,"column":8},"end":{"row":1723,"column":4},"action":"insert","lines":["    }","    "]},{"start":{"row":1724,"column":12},"end":{"row":1724,"column":15},"action":"insert","lines":["   "]},{"start":{"row":1724,"column":15},"end":{"row":1724,"column":16},"action":"insert","lines":[" "]},{"start":{"row":1725,"column":0},"end":{"row":1725,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1726,"column":12},"end":{"row":1726,"column":16},"action":"insert","lines":["    "]},{"start":{"row":1727,"column":12},"end":{"row":1727,"column":13},"action":"insert","lines":[" "]},{"start":{"row":1727,"column":13},"end":{"row":1727,"column":16},"action":"insert","lines":["   "]},{"start":{"row":1728,"column":16},"end":{"row":1728,"column":20},"action":"insert","lines":["    "]},{"start":{"row":1729,"column":0},"end":{"row":1729,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1730,"column":20},"end":{"row":1730,"column":24},"action":"insert","lines":["    "]},{"start":{"row":1731,"column":20},"end":{"row":1731,"column":24},"action":"insert","lines":["    "]},{"start":{"row":1732,"column":16},"end":{"row":1732,"column":18},"action":"insert","lines":["  "]},{"start":{"row":1732,"column":18},"end":{"row":1733,"column":0},"action":"remove","lines":["}",""]},{"start":{"row":1732,"column":18},"end":{"row":1733,"column":4},"action":"insert","lines":["  }","    "]},{"start":{"row":1734,"column":0},"end":{"row":1734,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1735,"column":16},"end":{"row":1735,"column":17},"action":"insert","lines":[" "]},{"start":{"row":1735,"column":17},"end":{"row":1735,"column":20},"action":"insert","lines":["   "]},{"start":{"row":1736,"column":0},"end":{"row":1736,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1737,"column":16},"end":{"row":1737,"column":19},"action":"insert","lines":["   "]},{"start":{"row":1737,"column":19},"end":{"row":1737,"column":20},"action":"insert","lines":[" "]},{"start":{"row":1738,"column":0},"end":{"row":1738,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1739,"column":20},"end":{"row":1739,"column":24},"action":"insert","lines":["    "]},{"start":{"row":1740,"column":20},"end":{"row":1740,"column":21},"action":"insert","lines":[" "]},{"start":{"row":1740,"column":21},"end":{"row":1740,"column":24},"action":"insert","lines":["   "]},{"start":{"row":1741,"column":0},"end":{"row":1741,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1742,"column":24},"end":{"row":1742,"column":27},"action":"insert","lines":["   "]},{"start":{"row":1742,"column":27},"end":{"row":1742,"column":28},"action":"insert","lines":[" "]},{"start":{"row":1743,"column":0},"end":{"row":1743,"column":4},"action":"insert","lines":["    "]},{"start":{"row":1744,"column":0},"end":{"row":1777,"column":0},"action":"insert","lines":["                        }","                    };","                    timer = setTimeout(fire, nextFrame);","                };","            }","            requestAnimationFrame(function(time) {","                var _ref1;","                if ((((_ref1 = window.performance) != null ? _ref1.now : void 0) != null) && time < 1e12) {","                    requestAnimationFrame.now = function() {","                        return window.performance.now() + window.performance.timing.navigationStart;","                    };","                    requestAnimationFrame.method = 'native-highres';","                } else {","                    requestAnimationFrame.now = now;","                }","            });","            requestAnimationFrame.now = ((_ref1 = window.performance) != null ? _ref1.now : void 0) != null ? (function() {","                return window.performance.now() + window.performance.timing.navigationStart;","            }) : now;","            requestAnimationFrame.method = method;","            window.requestAnimationFrame = requestAnimationFrame;","        })();","","        function loadScript(url, callback) {","","            var script = document.createElement(\"script\")","            script.type = \"text/javascript\";","","            if (script.readyState) { //IE","                script.onreadystatechange = function() {","                    if (script.readyState == \"loaded\" || script.readyState == \"complete\") {","                        script.onreadystatechange = null;","                        callback();",""]},{"start":{"row":1778,"column":0},"end":{"row":1779,"column":0},"action":"insert","lines":["",""]},{"start":{"row":1780,"column":12},"end":{"row":1781,"column":0},"action":"remove","lines":["    timer = setTimeout(fire, nextFrame);",""]},{"start":{"row":1780,"column":12},"end":{"row":1783,"column":3},"action":"insert","lines":["} else { //Others","                script.onload = function() {","                    callback();","   "]},{"start":{"row":1783,"column":15},"end":{"row":1783,"column":16},"action":"insert","lines":[" "]},{"start":{"row":1784,"column":8},"end":{"row":1784,"column":9},"action":"remove","lines":["}"]},{"start":{"row":1784,"column":8},"end":{"row":1785,"column":0},"action":"insert","lines":["    }",""]},{"start":{"row":1786,"column":8},"end":{"row":1791,"column":17},"action":"remove","lines":["requestAnimationFrame(function(time) {","            var _ref1;","            if ((((_ref1 = window.performance) != null ? _ref1.now : void 0) != null) && time < 1e12) {","                requestAnimationFrame.now = function() {","                    return window.performance.now() + window.performance.timing.navigationStart;","                }"]},{"start":{"row":1786,"column":8},"end":{"row":1800,"column":14},"action":"insert","lines":["    script.src = url;","            document.getElementsByTagName(\"head\")[0].appendChild(script);","        }","","        (function() {","","            //jQuery is only required for the Fixation flash fix. prototypejs is unable to efficiently replace elements","            //and introduces a 10 ms delay between loading element and firing off the scripts. Unacceptable","            //First time jQuery should be used is the second trial","","            loadScript(\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\", function() {","","                $.noConflict();","","            })"]},{"start":{"row":1801,"column":0},"end":{"row":1802,"column":0},"action":"insert","lines":["",""]},{"start":{"row":1802,"column":8},"end":{"row":1804,"column":0},"action":"insert","lines":["})();","",""]},{"start":{"row":1804,"column":8},"end":{"row":1809,"column":2},"action":"remove","lines":["requestAnimationFrame.method = 'native-highres';","            }","            else {","                requestAnimationFrame.now = now;","            }","  "]},{"start":{"row":1804,"column":8},"end":{"row":1810,"column":29},"action":"insert","lines":["//If preview mode is run (PreviewBanner element exists, add a QRTEngine plug with id QRTEPlug)","","        if ($('PreviewBanner')) {","            var plug, row, banner = $('PreviewBanner');","            //Go down to the first table row inside that banner","            row = banner.children[0].children[0].children[0];","            //Insert new cell"]},{"start":{"row":1810,"column":33},"end":{"row":1811,"column":0},"action":"insert","lines":["",""]},{"start":{"row":1811,"column":2},"end":{"row":1812,"column":0},"action":"remove","lines":["});",""]},{"start":{"row":1811,"column":10},"end":{"row":1815,"column":61},"action":"remove","lines":["requestAnimationFrame.now = ((_ref1 = window.performance) != null ? _ref1.now : void 0) != null ? (function() {","            return window.performance.now() + window.performance.timing.navigationStart;","        }) : now;","        requestAnimationFrame.method = method;","        window.requestAnimationFrame = requestAnimationFrame;"]},{"start":{"row":1811,"column":10},"end":{"row":1816,"column":9},"action":"insert","lines":["  plug = row.insertCell(2);","            plug.id = \"QRTEPlug\";","            plug.width = \"20%\";","            plug.innerHTML = 'This survey is proudly and successfully powered by <a href=\"http://qrtengine.com\" target=\"_blank\"><i><b>QRTEngine</b></i></a>';","            plug.style.textAlign = \"center\";","        }"]},{"start":{"row":1817,"column":5},"end":{"row":1817,"column":9},"action":"remove","lines":[")();"]},{"start":{"row":1820,"column":17},"end":{"row":1820,"column":21},"action":"remove","lines":["fals"]},{"start":{"row":1820,"column":17},"end":{"row":1820,"column":20},"action":"insert","lines":["tru"]},{"start":{"row":1826,"column":16},"end":{"row":1826,"column":17},"action":"insert","lines":[" "]},{"start":{"row":1829,"column":16},"end":{"row":1829,"column":17},"action":"insert","lines":[" "]},{"start":{"row":1832,"column":16},"end":{"row":1832,"column":17},"action":"insert","lines":[" "]},{"start":{"row":1835,"column":15},"end":{"row":1835,"column":16},"action":"insert","lines":[" "]},{"start":{"row":1838,"column":15},"end":{"row":1838,"column":16},"action":"insert","lines":[" "]},{"start":{"row":1839,"column":16},"end":{"row":1839,"column":17},"action":"insert","lines":[" "]},{"start":{"row":1841,"column":15},"end":{"row":1841,"column":16},"action":"insert","lines":[" "]},{"start":{"row":1850,"column":15},"end":{"row":1850,"column":16},"action":"insert","lines":[" "]},{"start":{"row":1851,"column":19},"end":{"row":1851,"column":20},"action":"insert","lines":[" "]},{"start":{"row":1854,"column":19},"end":{"row":1854,"column":20},"action":"insert","lines":[" "]},{"start":{"row":1866,"column":21},"end":{"row":1870,"column":18},"action":"insert","lines":[" !important;","    }","    #SkinContent > #Buttons,","    .SkinInner > #Header {","        padding: 0"]}],[{"start":{"row":2,"column":22},"end":{"row":2,"column":31},"action":"remove","lines":["7_jfe_fix"],"id":9629,"ignore":true},{"start":{"row":2,"column":22},"end":{"row":2,"column":23},"action":"insert","lines":["6"]},{"start":{"row":32,"column":20},"end":{"row":32,"column":29},"action":"remove","lines":["7_jfe_fix"]},{"start":{"row":32,"column":20},"end":{"row":32,"column":21},"action":"insert","lines":["6"]}],[{"start":{"row":2,"column":22},"end":{"row":2,"column":23},"action":"remove","lines":["6"],"id":9630,"ignore":true},{"start":{"row":2,"column":22},"end":{"row":2,"column":31},"action":"insert","lines":["7_jfe_fix"]},{"start":{"row":32,"column":20},"end":{"row":32,"column":21},"action":"remove","lines":["6"]},{"start":{"row":32,"column":20},"end":{"row":32,"column":29},"action":"insert","lines":["7_jfe_fix"]}],[{"start":{"row":2,"column":22},"end":{"row":2,"column":23},"action":"remove","lines":["7"],"id":9631,"ignore":true},{"start":{"row":2,"column":22},"end":{"row":2,"column":23},"action":"insert","lines":["5"]},{"start":{"row":4,"column":21},"end":{"row":4,"column":26},"action":"remove","lines":["-2014"]},{"start":{"row":10,"column":38},"end":{"row":10,"column":40},"action":"insert","lines":["_j"]},{"start":{"row":32,"column":0},"end":{"row":32,"column":31},"action":"remove","lines":["        version: 'v17_jfe_fix',"]},{"start":{"row":41,"column":10},"end":{"row":41,"column":11},"action":"insert","lines":[" "]},{"start":{"row":108,"column":52},"end":{"row":108,"column":53},"action":"insert","lines":[" "]},{"start":{"row":116,"column":48},"end":{"row":116,"column":49},"action":"insert","lines":[" "]},{"start":{"row":122,"column":0},"end":{"row":123,"column":0},"action":"remove","lines":["            //Store value in trial cache",""]},{"start":{"row":124,"column":0},"end":{"row":125,"column":0},"action":"remove","lines":["                //Add column to overall trial data",""]},{"start":{"row":139,"column":48},"end":{"row":139,"column":49},"action":"insert","lines":[" "]},{"start":{"row":150,"column":56},"end":{"row":150,"column":57},"action":"insert","lines":[" "]},{"start":{"row":167,"column":0},"end":{"row":169,"column":0},"action":"remove","lines":["            //Store blockData in ED so that we can use it next trial","            QRTEController.storeBlockData(QRTE.BDCache);",""]},{"start":{"row":173,"column":65},"end":{"row":173,"column":66},"action":"insert","lines":[" "]},{"start":{"row":195,"column":0},"end":{"row":196,"column":0},"action":"remove","lines":["            //This only works if the Survey Data has been set during the same trial due to a bug in Qualtrics.",""]},{"start":{"row":211,"column":13},"end":{"row":212,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":233,"column":13},"end":{"row":234,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":293,"column":0},"end":{"row":311,"column":0},"action":"remove","lines":["        /** ","         * Wait for images to load before starting trial.","         * @property waitForImageLoad","         * @private","         * @type Boolean","         */","","        waitForImageLoad: true,","","        /** ","         * Trial Start waiting list - initialised with waiting for TrialStart","         * @property loadWaitingList","         * @private","         * @type Array","         */","","        loadWaitingList: [false],","",""]},{"start":{"row":306,"column":31},"end":{"row":306,"column":33},"action":"remove","lines":["Id"]},{"start":{"row":306,"column":31},"end":{"row":306,"column":82},"action":"insert","lines":["DataString, blockId, columns, idData, exitQuestions"]},{"start":{"row":311,"column":12},"end":{"row":311,"column":14},"action":"insert","lines":["//"]},{"start":{"row":312,"column":0},"end":{"row":317,"column":0},"action":"remove","lines":["            //Initialise block Data","            blockDataString = Qualtrics.SurveyEngine.getEmbeddedData(this.blockDataField)|| '';","            columns = Qualtrics.SurveyEngine.getEmbeddedData(this.columnsField)|| '';","            idData = Qualtrics.SurveyEngine.getEmbeddedData(this.idField)|| '';","            exitQuestions = Qualtrics.SurveyEngine.getEmbeddedData(this.exitQuestions)|| '';",""]},{"start":{"row":317,"column":27},"end":{"row":317,"column":56},"action":"remove","lines":["QRTEController.loadBlockData("]},{"start":{"row":317,"column":42},"end":{"row":317,"column":52},"action":"insert","lines":[".evalJSON("]},{"start":{"row":320,"column":0},"end":{"row":321,"column":0},"action":"remove","lines":["                //If this is a new block, initialise a new block",""]},{"start":{"row":331,"column":0},"end":{"row":332,"column":0},"action":"remove","lines":["                //And update the exit questions",""]},{"start":{"row":345,"column":0},"end":{"row":355,"column":0},"action":"insert","lines":["            QRTE.log(QRTE.SDCache);","        },","        ","        deepClone: function(ele) {","           var clone = ele.clone();","           var children = ele.children;","           for(var i = 0; i < children.length; i += 1) {","               clone.appendChild(QRTE.deepClone(children[i]));","           }","           return  clone; ",""]},{"start":{"row":370,"column":0},"end":{"row":371,"column":0},"action":"remove","lines":["         *  @param [paramObj.waitForImages] {Boolean} Specify whether we should wait for images or not. Is on by default, but could be turned off if all images are pre-loaded in cache, or are very small in general.",""]},{"start":{"row":373,"column":14},"end":{"row":373,"column":30},"action":"remove","lines":["init the library"]},{"start":{"row":373,"column":14},"end":{"row":374,"column":0},"action":"insert","lines":["Quickly Hide the Questions in the Survey",""]},{"start":{"row":376,"column":0},"end":{"row":377,"column":0},"action":"remove","lines":["",""]},{"start":{"row":376,"column":14},"end":{"row":380,"column":31},"action":"remove","lines":["set the initIndex (if the Init question is not the first question of the block)","            QRTE.initIndex = paramObj.initQuestionIndex - 1 || 0;","","","            validationArray = ["]},{"start":{"row":376,"column":14},"end":{"row":395,"column":15},"action":"insert","lines":["QRTE.removeSeparators();","","            QRTE.initIndex = paramObj.initQuestionIndex - 1 || 0;","            ","            //UNCOMMENT","            //QRTE.debugFirst = QRTE.deepClone($$('.Skin')[0]);","","            validationArray = [{","                name: 'blockData',","                type: ['JSON', 'Empty'],","                required: true","            }, {","                name: 'columnData',","                type: ['JSON', 'Empty'],","                required: true","            }, {","                name: 'idData',","                type: ['JSON', 'Empty'],","                required: true","            }, "]},{"start":{"row":408,"column":27},"end":{"row":408,"column":34},"action":"remove","lines":["ItemTag"]},{"start":{"row":408,"column":27},"end":{"row":408,"column":36},"action":"insert","lines":["Questions"]},{"start":{"row":412,"column":23},"end":{"row":412,"column":36},"action":"remove","lines":["waitForImages"]},{"start":{"row":412,"column":23},"end":{"row":412,"column":34},"action":"insert","lines":["exitItemTag"]},{"start":{"row":413,"column":24},"end":{"row":413,"column":31},"action":"remove","lines":["Boolean"]},{"start":{"row":413,"column":24},"end":{"row":413,"column":30},"action":"insert","lines":["String"]},{"start":{"row":414,"column":26},"end":{"row":414,"column":30},"action":"remove","lines":["fals"]},{"start":{"row":414,"column":26},"end":{"row":414,"column":29},"action":"insert","lines":["tru"]},{"start":{"row":420,"column":0},"end":{"row":421,"column":0},"action":"remove","lines":["",""]},{"start":{"row":421,"column":39},"end":{"row":426,"column":13},"action":"remove","lines":["Id, paramObj.exitItemTag);","","","            if (paramObj.waitForImages !== undefined) {","                QRTE.waitForImageLoad = paramObj.waitForImages;","            }"]},{"start":{"row":421,"column":39},"end":{"row":422,"column":0},"action":"insert","lines":["Data, paramObj.blockId, paramObj.columnData, paramObj.idData, paramObj.exitQuestions, paramObj.exitItemTag);",""]},{"start":{"row":425,"column":0},"end":{"row":426,"column":0},"action":"remove","lines":["",""]},{"start":{"row":462,"column":13},"end":{"row":463,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":464,"column":61},"end":{"row":464,"column":62},"action":"insert","lines":[" "]},{"start":{"row":482,"column":0},"end":{"row":485,"column":0},"action":"remove","lines":["         *  @param [paramObj.onHideFn] {Function} Function to be called upon Stimulus being hidden","         *  @param [paramObj.duringDisplayFn] {Function} Function to be called during each frame that the Stimulus is being displayed","         ",""]},{"start":{"row":528,"column":0},"end":{"row":532,"column":0},"action":"remove","lines":["            }, {","                name: 'onHideFn',","                type: ['Function'],","                required: false",""]},{"start":{"row":539,"column":0},"end":{"row":540,"column":0},"action":"insert","lines":["            QRTE.log(paramObj.conditional);",""]},{"start":{"row":553,"column":0},"end":{"row":554,"column":0},"action":"insert","lines":["                this.hideChoices();",""]},{"start":{"row":559,"column":0},"end":{"row":561,"column":0},"action":"remove","lines":["                    duringDisplayFn: paramObj.duringDisplayFn,","                    onHideFn: paramObj.onHideFn,",""]},{"start":{"row":563,"column":0},"end":{"row":564,"column":0},"action":"insert","lines":["                    duringDisplayFn: paramObj.duringDisplayFn,",""]},{"start":{"row":581,"column":0},"end":{"row":582,"column":0},"action":"remove","lines":["",""]},{"start":{"row":581,"column":0},"end":{"row":582,"column":12},"action":"insert","lines":["            ","            "]},{"start":{"row":606,"column":93},"end":{"row":607,"column":74},"action":"remove","lines":["","                    QRTE.setTrialData('QRTEngine[Version]', QRTE.version);"]},{"start":{"row":611,"column":24},"end":{"row":611,"column":26},"action":"remove","lines":["//"]},{"start":{"row":637,"column":20},"end":{"row":640,"column":23},"action":"remove","lines":["//QRTE.submitPage();","                    //QRTEController.loadNextTrial();","                    ","                    $('"]},{"start":{"row":637,"column":20},"end":{"row":637,"column":30},"action":"insert","lines":["this.click"]},{"start":{"row":637,"column":40},"end":{"row":637,"column":48},"action":"remove","lines":["').click"]},{"start":{"row":651,"column":32},"end":{"row":651,"column":33},"action":"remove","lines":["0"]},{"start":{"row":654,"column":0},"end":{"row":655,"column":0},"action":"remove","lines":["",""]},{"start":{"row":654,"column":12},"end":{"row":654,"column":14},"action":"insert","lines":["//"]},{"start":{"row":654,"column":19},"end":{"row":671,"column":0},"action":"remove","lines":["loadWaitingList = [false];","            if (QRTE.waitForImageLoad === true) {","                //set wait for image load queues.","                var loadIndex = 1,","                    images = $$('.QuestionOuter img'),","                    i = 0;","","                var l = images.length;","                for (; i < l; i += 1) {","                    images[i].observe('load', function(e) {","                        QRTE.startTrial(e.target.QRTELoadIndex);","                    })","                    images[i].QRTELoadIndex = i + 1;","                    QRTE.loadWaitingList[i + 1] = false;","                }","","            }",""]},{"start":{"row":654,"column":19},"end":{"row":654,"column":64},"action":"insert","lines":["debugSecond = QRTE.deepClone($$('.Skin')[0]);"]},{"start":{"row":677,"column":29},"end":{"row":677,"column":36},"action":"remove","lines":["startId"]},{"start":{"row":682,"column":0},"end":{"row":688,"column":0},"action":"remove","lines":["            QRTE.loadWaitingList[startId] = true;","            if (!QRTE.loadWaitingList.every()) {","                QRTE.log('Process ' + startId + 'finished, waiting for other processes to finish')","                return;","            }","",""]},{"start":{"row":686,"column":0},"end":{"row":687,"column":0},"action":"insert","lines":["            //QRTE.debugThird = QRTE.deepClone($$('.Skin')[0]);",""]},{"start":{"row":697,"column":0},"end":{"row":698,"column":0},"action":"remove","lines":["                    //Get current time, required for ",""]},{"start":{"row":700,"column":35},"end":{"row":702,"column":28},"action":"insert","lines":["","                    /*var sum = 0,","                        i;*/"]},{"start":{"row":713,"column":13},"end":{"row":714,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":732,"column":0},"end":{"row":746,"column":0},"action":"remove","lines":["            QRTE.inited = true;","","            //Set initial trial data related to loading of this trial","            QRTE.setTrialData('InitServerComm[Onset]', QRTE.getBlockData('ServerCommOnset'));","            QRTE.setTrialData('InitServerComm[Offset]', QRTE.getBlockData('ServerCommOffset'));","            QRTE.setTrialData('InitServerComm[CalculatedDuration]', QRTE.getBlockData('ServerCommOffset') - QRTE.getBlockData('ServerCommOnset'));","","            //<Load next trial here>","            var currentLoops = '${lm://CurrentLoopNumber}',","                totalLoops = '${lm://TotalLoops}';","            //Check if last trial, currentloops === totalLoops;","            ","            //QRTEController.requestNextTrial(currentLoops !== '' && currentLoops === totalLoops);","",""]},{"start":{"row":795,"column":75},"end":{"row":795,"column":76},"action":"insert","lines":[" "]},{"start":{"row":809,"column":0},"end":{"row":810,"column":0},"action":"insert","lines":["",""]},{"start":{"row":854,"column":29},"end":{"row":855,"column":27},"action":"insert","lines":["","                           "]},{"start":{"row":867,"column":25},"end":{"row":868,"column":23},"action":"insert","lines":["","                       "]},{"start":{"row":904,"column":57},"end":{"row":905,"column":35},"action":"remove","lines":[",","                    id: question.id"]},{"start":{"row":1010,"column":12},"end":{"row":1010,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1011,"column":0},"end":{"row":1011,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1012,"column":20},"end":{"row":1012,"column":23},"action":"remove","lines":["   "]},{"start":{"row":1012,"column":20},"end":{"row":1012,"column":21},"action":"remove","lines":[" "]},{"start":{"row":1013,"column":0},"end":{"row":1013,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1014,"column":16},"end":{"row":1014,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1015,"column":16},"end":{"row":1015,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1015,"column":16},"end":{"row":1015,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1016,"column":0},"end":{"row":1016,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1017,"column":0},"end":{"row":1017,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1018,"column":16},"end":{"row":1018,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1019,"column":0},"end":{"row":1019,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1020,"column":16},"end":{"row":1020,"column":18},"action":"remove","lines":["  "]},{"start":{"row":1020,"column":16},"end":{"row":1020,"column":18},"action":"remove","lines":["  "]},{"start":{"row":1021,"column":16},"end":{"row":1021,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1022,"column":0},"end":{"row":1022,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1023,"column":16},"end":{"row":1023,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1023,"column":16},"end":{"row":1023,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1024,"column":16},"end":{"row":1024,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1025,"column":12},"end":{"row":1025,"column":15},"action":"remove","lines":["   "]},{"start":{"row":1025,"column":12},"end":{"row":1025,"column":13},"action":"remove","lines":[" "]},{"start":{"row":1026,"column":0},"end":{"row":1026,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1027,"column":16},"end":{"row":1027,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1028,"column":12},"end":{"row":1028,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1028,"column":12},"end":{"row":1028,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1029,"column":0},"end":{"row":1029,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1030,"column":0},"end":{"row":1030,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1112,"column":16},"end":{"row":1114,"column":17},"action":"remove","lines":["for (var i = 0; i < arguments.length; i += 1) {","                    console.log(arguments[i]);","                }"]},{"start":{"row":1112,"column":16},"end":{"row":1112,"column":39},"action":"insert","lines":["console.log(arguments);"]},{"start":{"row":1170,"column":12},"end":{"row":1170,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1171,"column":0},"end":{"row":1171,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1172,"column":0},"end":{"row":1172,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1173,"column":16},"end":{"row":1173,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1174,"column":12},"end":{"row":1174,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1175,"column":16},"end":{"row":1175,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1175,"column":16},"end":{"row":1175,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1176,"column":12},"end":{"row":1176,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1177,"column":16},"end":{"row":1177,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1177,"column":16},"end":{"row":1177,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1178,"column":12},"end":{"row":1178,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1178,"column":12},"end":{"row":1178,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1179,"column":0},"end":{"row":1179,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1180,"column":12},"end":{"row":1180,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1181,"column":16},"end":{"row":1181,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1181,"column":16},"end":{"row":1181,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1182,"column":12},"end":{"row":1182,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1183,"column":0},"end":{"row":1183,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1184,"column":12},"end":{"row":1184,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1185,"column":0},"end":{"row":1185,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1186,"column":12},"end":{"row":1186,"column":15},"action":"remove","lines":["   "]},{"start":{"row":1186,"column":12},"end":{"row":1186,"column":13},"action":"remove","lines":[" "]},{"start":{"row":1187,"column":0},"end":{"row":1187,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1191,"column":0},"end":{"row":1208,"column":0},"action":"remove","lines":["        fixSetEmbeddedDataBug: function() {","            Qualtrics.SurveyEngine.setEmbeddedData = function(key, value) {","                var fieldName = 'ED~' + key;","                if ($(fieldName)) {","                    $(fieldName).value = value;","                } else {","                    $('Header').appendChild(QBuilder('input', {","                        type: 'hidden',","                        id: fieldName,","                        name: fieldName,","                        value: value","                    }));","                    Qualtrics.SurveyEngine.setEmbeddedData(key, value);","                }","            }","        },","",""]},{"start":{"row":1224,"column":13},"end":{"row":1225,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":1243,"column":20},"end":{"row":1243,"column":55},"action":"remove","lines":["QRTE.proceedOnFrameEnd === true || "]},{"start":{"row":1246,"column":17},"end":{"row":1247,"column":15},"action":"insert","lines":["","               "]},{"start":{"row":1261,"column":17},"end":{"row":1262,"column":15},"action":"insert","lines":["","               "]},{"start":{"row":1273,"column":15},"end":{"row":1273,"column":16},"action":"remove","lines":["("]},{"start":{"row":1273,"column":64},"end":{"row":1273,"column":89},"action":"remove","lines":[" && QRTE.inited === true)"]},{"start":{"row":1287,"column":13},"end":{"row":1288,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":1315,"column":12},"end":{"row":1315,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1316,"column":12},"end":{"row":1316,"column":14},"action":"remove","lines":["//"]},{"start":{"row":1320,"column":0},"end":{"row":1322,"column":0},"action":"remove","lines":["","",""]},{"start":{"row":1320,"column":0},"end":{"row":1322,"column":12},"action":"insert","lines":["            ","            ","            "]},{"start":{"row":1329,"column":13},"end":{"row":1330,"column":11},"action":"insert","lines":["","           "]},{"start":{"row":1338,"column":0},"end":{"row":1338,"column":12},"action":"insert","lines":["            "]},{"start":{"row":1345,"column":12},"end":{"row":1345,"column":14},"action":"remove","lines":["//"]},{"start":{"row":1369,"column":0},"end":{"row":1369,"column":8},"action":"insert","lines":["        "]},{"start":{"row":1375,"column":8},"end":{"row":1375,"column":9},"action":"remove","lines":[" "]},{"start":{"row":1392,"column":0},"end":{"row":1392,"column":8},"action":"insert","lines":["        "]},{"start":{"row":1398,"column":8},"end":{"row":1398,"column":9},"action":"remove","lines":[" "]},{"start":{"row":1409,"column":58},"end":{"row":1409,"column":59},"action":"remove","lines":[" "]},{"start":{"row":1417,"column":9},"end":{"row":1417,"column":10},"action":"remove","lines":[","]},{"start":{"row":1420,"column":4},"end":{"row":1599,"column":89},"action":"remove","lines":["if (typeof QRTEController == 'undefined') {","        //QRTE SurveySlider controller layer","        //Takes care of progressing through the survey. Catches all qualtrics native ways of submitting the form and replaces that by","        //its own asynchronous ajax stuff.","        QRTEController = {","","","            //This plug-in to QRTEngine has been developed under the name SurveySlider","            // for general Qualtrics Surveys. It has been adapted to work with QRTEngine","            nextTrialContainer: null,","            nextTrialText: '',","            currentForm: null,","            previousForm: null,","            handlingSubmit: false,","            onSubmitStack: [],","            inited: false,","            childInputs: [],","            loadUponCallback: false,","            setEmbeddedData: function() {},","            tempED: {},","","","","            //Initialize thecontroller","            init: function() {","                this.nextTrialContainer = new Element('div', {","                    id: 'nextTrialContainer'","                });","                this.currentForm = $$('form')[0];","                //Catch submits and change it with our own submit function (which does AJAX submissions)","                //this.currentForm.observe('QRTE:submit', QRTE.handleSubmit);","                this.currentElements = $$('.QuestionOuter');","","                //Initial SSload firing","                Qualtrics.SurveyEngine.addOnload(function() {","                    QRTEController.currentForm.fire('QRTE:load');","                });","                //Change SurveyEngine.OnLoad to trigger on SSload, rather than page load","                Qualtrics.SurveyEngine.addOnload = function(e) {","                        var questions = $$('.QuestionOuter'),","                            currentCount = QRTEController.count(Qualtrics.SurveyEngine.QuestionInfo),","                            id = questions[currentCount - 1].id;","                        var t = new Qualtrics.SurveyEngine.QuestionData;","                        this.Page.once(\"preready\", function() {","                            try {","                                e.apply(t)","                            } catch (n) {","                                s.error(\"SE API Error: \", n, e)","                            }","                        })","                    }","                    //Set the Qualtrics setEmbeddedData to inside the QRTEController","                ","                // Overwrite Page.__advancePage","                advancePage = Page.__advancePage","                ","                Page.__advancePage = function(e,t,n) {","                    console.log(e,t,n)","                    advancePage.apply(Page,[e,t,n])","                }","                QRTEController.setEmbeddedData = Qualtrics.SurveyEngine.setEmbeddedData;","                Qualtrics.SurveyEngine.setEmbeddedData = function(key, value) {","                    QRTEController.tempED[key] = value;","                }","                this.submitPage = this.requestNextTrial;","                this.inited = true;","            },","","            /**","             * Requests the next trial from the Qualtrics server.","             *","             *","             */","            requestNextTrial: function(isLastTrial) {","","                //If this is the last trial of a block, DON'T request the next page, let qualtrics handle it themselves","                if (this.handlingSubmit === false && isLastTrial === false) {","                    //Load next trial means that current page is a trial and has been inited","                    //Need to remove relevant input elements from current form before submitting","                    //After that add them back","                    this.handlingSubmit = true","                    var childs = $$('form input[type=text]'),","                        childInputs = [];","                    //remove current input elements from the form","                    for (var i = 0; i < childs.length; i += 1) {","                        childInputs[i] = {","                            ele: childs[i],","                            parent: childs[i].up()","                        };","                        childs[i].remove();","                    }","                    //add previous input elements to form","                    //Text inputs","                    for (var i = 0; i < this.childInputs.length; i += 1) {","                        this.childInputs[i].ele.style.display = 'none';","                        this.currentForm.insert(this.childInputs[i].ele);","                    }","","","                    //And embedded data","                    for (var key in this.tempED) {","                        if (this.tempED.hasOwnProperty(key)) {","                            QRTEController.setEmbeddedData(key, this.tempED[key]);","                        }","                    }","                    //Reset stored embedded data","                    this.tempED = {};","                    //set new childs","                    this.childInputs = childInputs;","","                    //Loop over submit stack, or callbacks that need to be finished before submitting","                    for (var i = 0; i < QRTEController.onSubmitStack.length; i += 1) {","                        QRTE.onSubmitStack[i]();","                    }","                    QRTEController.onSubmitStack = [];","                    ","                    ","                    Page.adapter.next(Page.serializePageRuntime()).then(function(data) {QRTEController.requestNextTrialCallback(data)})","","                    //Set server comm onset for the next trial","                    QRTE.setBlockData('ServerCommOnset', window.requestAnimationFrame.now());","","                    QRTEController.betweenSubmits = true;","","                    for (var i = 0; i < this.childInputs.length; i += 1) {","                        this.childInputs[i].parent.insert(this.childInputs[i].ele);","                        this.childInputs[i].ele.style.display = 'none';","                    }","                } else if (isLastTrial === true) {","                    //Just add the previous trial's childInputs to the form ","                    for (var i = 0; i < this.childInputs.length; i += 1) {","","                        this.currentForm.insert(this.childInputs[i].ele);","                        this.childInputs[i].ele.style.display = 'none';","                    }","","                    this.loadNextTrial = function() {","                        //Directly submitting the form doesn't seem to work? Let's do it through NextButton click","                        $('NextButton').click();","                    };","                }","            },","","            loadNextTrial: function() {","                if (this.handlingSubmit === true) {","                    //The submit still hasn't returned..","                    this.loadUponCallback = true;","                    return;","","                }","                //Set handling submit to false (as page has been returned)","                //Save the previous form","                this.previousForm = this.currentForm;","                //Reset the QuestionInfo object, this is for Qualtrics to correctly initiate its own page","                Qualtrics.SurveyEngine.QuestionInfo = {}","                ","                /** Load template into Qualtrics Page","                */","                ","                    //Parse the HTML that was returned earlier and set it as the current trial container's contents","                Page._renderPageTemplate(this.nextTrialText,\"next\"); //this.nextTrialContainer = jQuery(this.nextTrialContainer).html(this.nextTrialText)[0];","                //Filter out the 'form' field, and append it back.","                ","                this.currentForm = jQuery('form')[0];","                jQuery(this.previousForm).replaceWith(jQuery(this.currentForm));","","                jQuery(this.currentForm).show();","                if (this.currentForm.select('.END_OF_SURVEY').length === 0) {","                    this.currentForm.fire('QRTE:load');","                    this.submitPage = this.requestNextTrial;","                } else {","                    this.submitPage = this.currentForm.submit;","                }","","            },","","            requestNextTrialCallback: function(e) {","                QRTEController.nextTrialText = e;","                QRTEController.handlingSubmit = false;","                QRTE.setBlockData('ServerCommOffset', window.requestAnimationFrame.now())"]},{"start":{"row":1420,"column":4},"end":{"row":1430,"column":152},"action":"insert","lines":["//If preview mode is run (PreviewBanner element exists, add a QRTEngine plug with id QRTEPlug)","","    if ($('PreviewBanner')) {","        var plug, row, banner = $('PreviewBanner');","        //Go down to the first table row inside that banner","        row = banner.children[0].children[0].children[0];","        //Insert new cell    ","        plug = row.insertCell(2);","        plug.id = \"QRTEPlug\";","        plug.width = \"20%\";","        plug.innerHTML = 'This survey is proudly and successfully powered by <a href=\"http://qrtengine.com\" target=\"_blank\"><i><b>QRTEngine</b></i></a>'"]},{"start":{"row":1431,"column":0},"end":{"row":1432,"column":0},"action":"remove","lines":["",""]},{"start":{"row":1431,"column":8},"end":{"row":1473,"column":4},"action":"remove","lines":["        if (QRTEController.loadUponCallback === true) {","                    QRTEController.loadUponCallback = false;","                    QRTEController.loadNextTrial();","                }","            },","","            submitPage: function() {","                console.log('Not yet initialised');","            },","","            count: function(obj) {","                var count = 0;","","                for (var prop in obj) {","                    if (obj.hasOwnProperty(prop))","                        ++count;","                }","","                return count;","            },","","            BDCache: {},","            storeBlockData: function(blockData) {","                this.BDCache = blockData;","            },","","            loadBlockData: function() {","                return this.BDCache;","            }","        };","        ","        ","        if(document.readyState === \"complete\" && QRTEController.inited === false) {","          //Already loaded!","          QRTEController.init();","        }","        else {","            document.observe('dom:loaded', QRTEController.init.bind(QRTEController));","        }","","","","    "]},{"start":{"row":1431,"column":8},"end":{"row":1435,"column":0},"action":"insert","lines":["plug.style.textAlign = \"center\";","    }","</script>","<script>",""]},{"start":{"row":1436,"column":0},"end":{"row":1436,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1437,"column":8},"end":{"row":1437,"column":10},"action":"remove","lines":["  "]},{"start":{"row":1437,"column":8},"end":{"row":1437,"column":10},"action":"remove","lines":["  "]},{"start":{"row":1438,"column":0},"end":{"row":1438,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1439,"column":12},"end":{"row":1439,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1440,"column":8},"end":{"row":1440,"column":9},"action":"remove","lines":[" "]},{"start":{"row":1440,"column":8},"end":{"row":1441,"column":4},"action":"remove","lines":["   };","    "]},{"start":{"row":1440,"column":8},"end":{"row":1441,"column":0},"action":"insert","lines":["};",""]},{"start":{"row":1442,"column":8},"end":{"row":1442,"column":11},"action":"remove","lines":["   "]},{"start":{"row":1442,"column":8},"end":{"row":1442,"column":9},"action":"remove","lines":[" "]},{"start":{"row":1443,"column":0},"end":{"row":1443,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1444,"column":12},"end":{"row":1444,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1445,"column":12},"end":{"row":1445,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1445,"column":12},"end":{"row":1445,"column":14},"action":"remove","lines":["  "]},{"start":{"row":1446,"column":0},"end":{"row":1446,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1447,"column":0},"end":{"row":1447,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1448,"column":8},"end":{"row":1449,"column":4},"action":"remove","lines":["    }","    "]},{"start":{"row":1448,"column":8},"end":{"row":1449,"column":0},"action":"insert","lines":["}",""]},{"start":{"row":1450,"column":12},"end":{"row":1450,"column":15},"action":"remove","lines":["   "]},{"start":{"row":1450,"column":12},"end":{"row":1450,"column":13},"action":"remove","lines":[" "]},{"start":{"row":1451,"column":0},"end":{"row":1451,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1452,"column":12},"end":{"row":1452,"column":16},"action":"remove","lines":["    "]},{"start":{"row":1453,"column":12},"end":{"row":1453,"column":13},"action":"remove","lines":[" "]},{"start":{"row":1453,"column":12},"end":{"row":1453,"column":15},"action":"remove","lines":["   "]},{"start":{"row":1454,"column":16},"end":{"row":1454,"column":20},"action":"remove","lines":["    "]},{"start":{"row":1455,"column":0},"end":{"row":1455,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1456,"column":20},"end":{"row":1456,"column":24},"action":"remove","lines":["    "]},{"start":{"row":1457,"column":20},"end":{"row":1457,"column":24},"action":"remove","lines":["    "]},{"start":{"row":1458,"column":16},"end":{"row":1458,"column":18},"action":"remove","lines":["  "]},{"start":{"row":1458,"column":16},"end":{"row":1459,"column":4},"action":"remove","lines":["  }","    "]},{"start":{"row":1458,"column":16},"end":{"row":1459,"column":0},"action":"insert","lines":["}",""]},{"start":{"row":1460,"column":0},"end":{"row":1460,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1461,"column":16},"end":{"row":1461,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1461,"column":16},"end":{"row":1461,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1462,"column":0},"end":{"row":1462,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1463,"column":16},"end":{"row":1463,"column":19},"action":"remove","lines":["   "]},{"start":{"row":1463,"column":16},"end":{"row":1463,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1464,"column":0},"end":{"row":1464,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1465,"column":20},"end":{"row":1465,"column":24},"action":"remove","lines":["    "]},{"start":{"row":1466,"column":20},"end":{"row":1466,"column":21},"action":"remove","lines":[" "]},{"start":{"row":1466,"column":20},"end":{"row":1466,"column":23},"action":"remove","lines":["   "]},{"start":{"row":1467,"column":0},"end":{"row":1467,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1468,"column":24},"end":{"row":1468,"column":27},"action":"remove","lines":["   "]},{"start":{"row":1468,"column":24},"end":{"row":1468,"column":25},"action":"remove","lines":[" "]},{"start":{"row":1469,"column":0},"end":{"row":1469,"column":4},"action":"remove","lines":["    "]},{"start":{"row":1470,"column":0},"end":{"row":1503,"column":0},"action":"remove","lines":["                        }","                    };","                    timer = setTimeout(fire, nextFrame);","                };","            }","            requestAnimationFrame(function(time) {","                var _ref1;","                if ((((_ref1 = window.performance) != null ? _ref1.now : void 0) != null) && time < 1e12) {","                    requestAnimationFrame.now = function() {","                        return window.performance.now() + window.performance.timing.navigationStart;","                    };","                    requestAnimationFrame.method = 'native-highres';","                } else {","                    requestAnimationFrame.now = now;","                }","            });","            requestAnimationFrame.now = ((_ref1 = window.performance) != null ? _ref1.now : void 0) != null ? (function() {","                return window.performance.now() + window.performance.timing.navigationStart;","            }) : now;","            requestAnimationFrame.method = method;","            window.requestAnimationFrame = requestAnimationFrame;","        })();","","        function loadScript(url, callback) {","","            var script = document.createElement(\"script\")","            script.type = \"text/javascript\";","","            if (script.readyState) { //IE","                script.onreadystatechange = function() {","                    if (script.readyState == \"loaded\" || script.readyState == \"complete\") {","                        script.onreadystatechange = null;","                        callback();",""]},{"start":{"row":1471,"column":0},"end":{"row":1472,"column":0},"action":"remove","lines":["",""]},{"start":{"row":1472,"column":12},"end":{"row":1475,"column":3},"action":"remove","lines":["} else { //Others","                script.onload = function() {","                    callback();","   "]},{"start":{"row":1472,"column":12},"end":{"row":1473,"column":0},"action":"insert","lines":["    timer = setTimeout(fire, nextFrame);",""]},{"start":{"row":1473,"column":12},"end":{"row":1473,"column":13},"action":"remove","lines":[" "]},{"start":{"row":1474,"column":8},"end":{"row":1475,"column":0},"action":"remove","lines":["    }",""]},{"start":{"row":1474,"column":8},"end":{"row":1474,"column":9},"action":"insert","lines":["}"]},{"start":{"row":1475,"column":8},"end":{"row":1489,"column":14},"action":"remove","lines":["    script.src = url;","            document.getElementsByTagName(\"head\")[0].appendChild(script);","        }","","        (function() {","","            //jQuery is only required for the Fixation flash fix. prototypejs is unable to efficiently replace elements","            //and introduces a 10 ms delay between loading element and firing off the scripts. Unacceptable","            //First time jQuery should be used is the second trial","","            loadScript(\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js\", function() {","","                $.noConflict();","","            })"]},{"start":{"row":1475,"column":8},"end":{"row":1480,"column":17},"action":"insert","lines":["requestAnimationFrame(function(time) {","            var _ref1;","            if ((((_ref1 = window.performance) != null ? _ref1.now : void 0) != null) && time < 1e12) {","                requestAnimationFrame.now = function() {","                    return window.performance.now() + window.performance.timing.navigationStart;","                }"]},{"start":{"row":1481,"column":0},"end":{"row":1482,"column":0},"action":"remove","lines":["",""]},{"start":{"row":1481,"column":8},"end":{"row":1483,"column":0},"action":"remove","lines":["})();","",""]},{"start":{"row":1481,"column":16},"end":{"row":1487,"column":29},"action":"remove","lines":["//If preview mode is run (PreviewBanner element exists, add a QRTEngine plug with id QRTEPlug)","","        if ($('PreviewBanner')) {","            var plug, row, banner = $('PreviewBanner');","            //Go down to the first table row inside that banner","            row = banner.children[0].children[0].children[0];","            //Insert new cell"]},{"start":{"row":1481,"column":16},"end":{"row":1486,"column":2},"action":"insert","lines":["requestAnimationFrame.method = 'native-highres';","            }","            else {","                requestAnimationFrame.now = now;","            }","  "]},{"start":{"row":1486,"column":6},"end":{"row":1487,"column":1},"action":"remove","lines":[""," "]},{"start":{"row":1486,"column":8},"end":{"row":1487,"column":0},"action":"insert","lines":["});",""]},{"start":{"row":1487,"column":8},"end":{"row":1492,"column":9},"action":"remove","lines":[" plug = row.insertCell(2);","            plug.id = \"QRTEPlug\";","            plug.width = \"20%\";","            plug.innerHTML = 'This survey is proudly and successfully powered by <a href=\"http://qrtengine.com\" target=\"_blank\"><i><b>QRTEngine</b></i></a>';","            plug.style.textAlign = \"center\";","        }"]},{"start":{"row":1487,"column":8},"end":{"row":1491,"column":61},"action":"insert","lines":["requestAnimationFrame.now = ((_ref1 = window.performance) != null ? _ref1.now : void 0) != null ? (function() {","            return window.performance.now() + window.performance.timing.navigationStart;","        }) : now;","        requestAnimationFrame.method = method;","        window.requestAnimationFrame = requestAnimationFrame;"]},{"start":{"row":1492,"column":5},"end":{"row":1492,"column":9},"action":"insert","lines":[")();"]},{"start":{"row":1495,"column":17},"end":{"row":1495,"column":20},"action":"remove","lines":["tru"]},{"start":{"row":1495,"column":17},"end":{"row":1495,"column":21},"action":"insert","lines":["fals"]},{"start":{"row":1501,"column":16},"end":{"row":1501,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1504,"column":16},"end":{"row":1504,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1507,"column":16},"end":{"row":1507,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1510,"column":15},"end":{"row":1510,"column":16},"action":"remove","lines":[" "]},{"start":{"row":1513,"column":15},"end":{"row":1513,"column":16},"action":"remove","lines":[" "]},{"start":{"row":1514,"column":16},"end":{"row":1514,"column":17},"action":"remove","lines":[" "]},{"start":{"row":1516,"column":15},"end":{"row":1516,"column":16},"action":"remove","lines":[" "]},{"start":{"row":1525,"column":15},"end":{"row":1525,"column":16},"action":"remove","lines":[" "]},{"start":{"row":1526,"column":19},"end":{"row":1526,"column":20},"action":"remove","lines":[" "]},{"start":{"row":1529,"column":19},"end":{"row":1529,"column":20},"action":"remove","lines":[" "]},{"start":{"row":1541,"column":21},"end":{"row":1545,"column":18},"action":"remove","lines":[" !important;","    }","    #SkinContent > #Buttons,","    .SkinInner > #Header {","        padding: 0"]}],[{"start":{"row":1542,"column":5},"end":{"row":1544,"column":6},"action":"insert","lines":["#SkinContent > #Buttons,.SkinInner > #Header {","+        padding: 0 !important;","+    }"],"id":9632}],[{"start":{"row":1543,"column":0},"end":{"row":1543,"column":1},"action":"remove","lines":["+"],"id":9633}],[{"start":{"row":1544,"column":0},"end":{"row":1544,"column":1},"action":"remove","lines":["+"],"id":9634}],[{"start":{"row":1542,"column":5},"end":{"row":1543,"column":0},"action":"insert","lines":["",""],"id":9635},{"start":{"row":1543,"column":0},"end":{"row":1543,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":427,"column":85},"end":{"row":427,"column":138},"action":"insert","lines":["QRTE.setTrialDatA('QRTEngine[Version]',QRTE.version);"],"id":9636}],[{"start":{"row":427,"column":85},"end":{"row":428,"column":0},"action":"insert","lines":["",""],"id":9637},{"start":{"row":428,"column":0},"end":{"row":428,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":428,"column":28},"end":{"row":428,"column":29},"action":"remove","lines":["A"],"id":9638}],[{"start":{"row":428,"column":28},"end":{"row":428,"column":29},"action":"insert","lines":["a"],"id":9639}]]},"ace":{"folds":[],"scrolltop":4811.726941108704,"scrollleft":0,"selection":{"start":{"row":434,"column":45},"end":{"row":434,"column":45},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":406,"state":["#tmp","no_regex","start","no_regex","start","no_regex","start","jsx","jsx",1],"mode":"ace/mode/javascript"}},"timestamp":1448200753571,"hash":"ae3b083d06f5e694fbc5fe79f7734c213e042981"}